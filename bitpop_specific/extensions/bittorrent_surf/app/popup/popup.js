/*
 MIT License - http://www.opensource.org/licenses/mit-license.php

 For usage and examples, visit:
 http://timeago.yarp.com/

 Copyright (c) 2008-2012, Ryan McGeary (ryan -[at]- mcgeary [*dot*] org)
*/
define("main",["require","popup.require.config"],function(a,e){global_require.config(e);return{init:function(d,c){a(["app"],function(f){window.app=new f(c);_sandbox.observer.load("gaq").trigger("track:page","/popup.html")})}}});define("app/popup",function(){});var Handlebars={VERSION:"1.0.beta.6",helpers:{},partials:{},registerHelper:function(a,e,d){d&&(e.not=d);this.helpers[a]=e},registerPartial:function(a,e){this.partials[a]=e}};
Handlebars.registerHelper("helperMissing",function(a){if(2!==arguments.length)throw Error("Could not find property '"+a+"'");});var toString=Object.prototype.toString,functionType="[object Function]";
Handlebars.registerHelper("blockHelperMissing",function(a,e){var d=e.inverse||function(){},c=e.fn,f="",b=toString.call(a);b===functionType&&(a=a.call(this));if(!0===a)return c(this);if(!1===a||null==a)return d(this);if("[object Array]"===b){if(0<a.length){d=0;for(b=a.length;d<b;d++)f+=c(a[d])}else f=d(this);return f}return c(a)});Handlebars.registerHelper("each",function(a,e){var d=e.fn,c=e.inverse,f="";if(a&&0<a.length)for(var c=0,b=a.length;c<b;c++)f+=d(a[c]);else f=c(this);return f});
Handlebars.registerHelper("if",function(a,e){toString.call(a)===functionType&&(a=a.call(this));return!a||Handlebars.Utils.isEmpty(a)?e.inverse(this):e.fn(this)});Handlebars.registerHelper("unless",function(a,e){var d=e.fn;e.fn=e.inverse;e.inverse=d;return Handlebars.helpers["if"].call(this,a,e)});Handlebars.registerHelper("with",function(a,e){return e.fn(a)});Handlebars.registerHelper("log",function(a){Handlebars.log(a)});
var handlebars=function(){return{trace:function(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,statements:6,simpleInverse:7,statement:8,openInverse:9,closeBlock:10,openBlock:11,mustache:12,partial:13,CONTENT:14,COMMENT:15,OPEN_BLOCK:16,inMustache:17,CLOSE:18,OPEN_INVERSE:19,OPEN_ENDBLOCK:20,path:21,OPEN:22,OPEN_UNESCAPED:23,OPEN_PARTIAL:24,params:25,hash:26,param:27,STRING:28,INTEGER:29,BOOLEAN:30,hashSegments:31,hashSegment:32,ID:33,EQUALS:34,pathSegments:35,SEP:36,$accept:0,$end:1},terminals_:{2:"error",
5:"EOF",14:"CONTENT",15:"COMMENT",16:"OPEN_BLOCK",18:"CLOSE",19:"OPEN_INVERSE",20:"OPEN_ENDBLOCK",22:"OPEN",23:"OPEN_UNESCAPED",24:"OPEN_PARTIAL",28:"STRING",29:"INTEGER",30:"BOOLEAN",33:"ID",34:"EQUALS",36:"SEP"},productions_:[0,[3,2],[4,3],[4,1],[4,0],[6,1],[6,2],[8,3],[8,3],[8,1],[8,1],[8,1],[8,1],[11,3],[9,3],[10,3],[12,3],[12,3],[13,3],[13,4],[7,2],[17,3],[17,2],[17,2],[17,1],[25,2],[25,1],[27,1],[27,1],[27,1],[27,1],[26,1],[31,2],[31,1],[32,3],[32,3],[32,3],[32,3],[21,1],[35,3],[35,1]],performAction:function(a,
e,d,c,f,b){a=b.length-1;switch(f){case 1:return b[a-1];case 2:this.$=new c.ProgramNode(b[a-2],b[a]);break;case 3:this.$=new c.ProgramNode(b[a]);break;case 4:this.$=new c.ProgramNode([]);break;case 5:this.$=[b[a]];break;case 6:b[a-1].push(b[a]);this.$=b[a-1];break;case 7:this.$=new c.InverseNode(b[a-2],b[a-1],b[a]);break;case 8:this.$=new c.BlockNode(b[a-2],b[a-1],b[a]);break;case 9:this.$=b[a];break;case 10:this.$=b[a];break;case 11:this.$=new c.ContentNode(b[a]);break;case 12:this.$=new c.CommentNode(b[a]);
break;case 13:this.$=new c.MustacheNode(b[a-1][0],b[a-1][1]);break;case 14:this.$=new c.MustacheNode(b[a-1][0],b[a-1][1]);break;case 15:this.$=b[a-1];break;case 16:this.$=new c.MustacheNode(b[a-1][0],b[a-1][1]);break;case 17:this.$=new c.MustacheNode(b[a-1][0],b[a-1][1],!0);break;case 18:this.$=new c.PartialNode(b[a-1]);break;case 19:this.$=new c.PartialNode(b[a-2],b[a-1]);break;case 21:this.$=[[b[a-2]].concat(b[a-1]),b[a]];break;case 22:this.$=[[b[a-1]].concat(b[a]),null];break;case 23:this.$=[[b[a-
1]],b[a]];break;case 24:this.$=[[b[a]],null];break;case 25:b[a-1].push(b[a]);this.$=b[a-1];break;case 26:this.$=[b[a]];break;case 27:this.$=b[a];break;case 28:this.$=new c.StringNode(b[a]);break;case 29:this.$=new c.IntegerNode(b[a]);break;case 30:this.$=new c.BooleanNode(b[a]);break;case 31:this.$=new c.HashNode(b[a]);break;case 32:b[a-1].push(b[a]);this.$=b[a-1];break;case 33:this.$=[b[a]];break;case 34:this.$=[b[a-2],b[a]];break;case 35:this.$=[b[a-2],new c.StringNode(b[a])];break;case 36:this.$=
[b[a-2],new c.IntegerNode(b[a])];break;case 37:this.$=[b[a-2],new c.BooleanNode(b[a])];break;case 38:this.$=new c.IdNode(b[a]);break;case 39:b[a-2].push(b[a]);this.$=b[a-2];break;case 40:this.$=[b[a]]}},table:[{3:1,4:2,5:[2,4],6:3,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],24:[1,15]},{1:[3]},{5:[1,16]},{5:[2,3],7:17,8:18,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,19],20:[2,3],22:[1,13],23:[1,14],24:[1,15]},{5:[2,5],14:[2,5],15:[2,5],16:[2,5],19:[2,
5],20:[2,5],22:[2,5],23:[2,5],24:[2,5]},{4:20,6:3,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,4],22:[1,13],23:[1,14],24:[1,15]},{4:21,6:3,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,4],22:[1,13],23:[1,14],24:[1,15]},{5:[2,9],14:[2,9],15:[2,9],16:[2,9],19:[2,9],20:[2,9],22:[2,9],23:[2,9],24:[2,9]},{5:[2,10],14:[2,10],15:[2,10],16:[2,10],19:[2,10],20:[2,10],22:[2,10],23:[2,10],24:[2,10]},{5:[2,11],14:[2,11],15:[2,11],16:[2,11],19:[2,11],20:[2,11],22:[2,
11],23:[2,11],24:[2,11]},{5:[2,12],14:[2,12],15:[2,12],16:[2,12],19:[2,12],20:[2,12],22:[2,12],23:[2,12],24:[2,12]},{17:22,21:23,33:[1,25],35:24},{17:26,21:23,33:[1,25],35:24},{17:27,21:23,33:[1,25],35:24},{17:28,21:23,33:[1,25],35:24},{21:29,33:[1,25],35:24},{1:[2,1]},{6:30,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],24:[1,15]},{5:[2,6],14:[2,6],15:[2,6],16:[2,6],19:[2,6],20:[2,6],22:[2,6],23:[2,6],24:[2,6]},{17:22,18:[1,31],21:23,33:[1,25],35:24},{10:32,20:[1,
33]},{10:34,20:[1,33]},{18:[1,35]},{18:[2,24],21:40,25:36,26:37,27:38,28:[1,41],29:[1,42],30:[1,43],31:39,32:44,33:[1,45],35:24},{18:[2,38],28:[2,38],29:[2,38],30:[2,38],33:[2,38],36:[1,46]},{18:[2,40],28:[2,40],29:[2,40],30:[2,40],33:[2,40],36:[2,40]},{18:[1,47]},{18:[1,48]},{18:[1,49]},{18:[1,50],21:51,33:[1,25],35:24},{5:[2,2],8:18,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,2],22:[1,13],23:[1,14],24:[1,15]},{14:[2,20],15:[2,20],16:[2,20],19:[2,20],22:[2,20],23:[2,20],24:[2,
20]},{5:[2,7],14:[2,7],15:[2,7],16:[2,7],19:[2,7],20:[2,7],22:[2,7],23:[2,7],24:[2,7]},{21:52,33:[1,25],35:24},{5:[2,8],14:[2,8],15:[2,8],16:[2,8],19:[2,8],20:[2,8],22:[2,8],23:[2,8],24:[2,8]},{14:[2,14],15:[2,14],16:[2,14],19:[2,14],20:[2,14],22:[2,14],23:[2,14],24:[2,14]},{18:[2,22],21:40,26:53,27:54,28:[1,41],29:[1,42],30:[1,43],31:39,32:44,33:[1,45],35:24},{18:[2,23]},{18:[2,26],28:[2,26],29:[2,26],30:[2,26],33:[2,26]},{18:[2,31],32:55,33:[1,56]},{18:[2,27],28:[2,27],29:[2,27],30:[2,27],33:[2,
27]},{18:[2,28],28:[2,28],29:[2,28],30:[2,28],33:[2,28]},{18:[2,29],28:[2,29],29:[2,29],30:[2,29],33:[2,29]},{18:[2,30],28:[2,30],29:[2,30],30:[2,30],33:[2,30]},{18:[2,33],33:[2,33]},{18:[2,40],28:[2,40],29:[2,40],30:[2,40],33:[2,40],34:[1,57],36:[2,40]},{33:[1,58]},{14:[2,13],15:[2,13],16:[2,13],19:[2,13],20:[2,13],22:[2,13],23:[2,13],24:[2,13]},{5:[2,16],14:[2,16],15:[2,16],16:[2,16],19:[2,16],20:[2,16],22:[2,16],23:[2,16],24:[2,16]},{5:[2,17],14:[2,17],15:[2,17],16:[2,17],19:[2,17],20:[2,17],22:[2,
17],23:[2,17],24:[2,17]},{5:[2,18],14:[2,18],15:[2,18],16:[2,18],19:[2,18],20:[2,18],22:[2,18],23:[2,18],24:[2,18]},{18:[1,59]},{18:[1,60]},{18:[2,21]},{18:[2,25],28:[2,25],29:[2,25],30:[2,25],33:[2,25]},{18:[2,32],33:[2,32]},{34:[1,57]},{21:61,28:[1,62],29:[1,63],30:[1,64],33:[1,25],35:24},{18:[2,39],28:[2,39],29:[2,39],30:[2,39],33:[2,39],36:[2,39]},{5:[2,19],14:[2,19],15:[2,19],16:[2,19],19:[2,19],20:[2,19],22:[2,19],23:[2,19],24:[2,19]},{5:[2,15],14:[2,15],15:[2,15],16:[2,15],19:[2,15],20:[2,
15],22:[2,15],23:[2,15],24:[2,15]},{18:[2,34],33:[2,34]},{18:[2,35],33:[2,35]},{18:[2,36],33:[2,36]},{18:[2,37],33:[2,37]}],defaultActions:{16:[2,1],37:[2,23],53:[2,21]},parseError:function(a){throw Error(a);},parse:function(a){var e=[0],d=[null],c=[],f=this.table,b="",i=0,m=0,h=0;this.lexer.setInput(a);this.lexer.yy=this.yy;this.yy.lexer=this.lexer;"undefined"==typeof this.lexer.yylloc&&(this.lexer.yylloc={});a=this.lexer.yylloc;c.push(a);"function"===typeof this.yy.parseError&&(this.parseError=
this.yy.parseError);for(var g,j,l,k,q={},r,s;;){l=e[e.length-1];this.defaultActions[l]?k=this.defaultActions[l]:(null==g&&(g=void 0,g=this.lexer.lex()||1,"number"!==typeof g&&(g=this.symbols_[g]||g)),k=f[l]&&f[l][g]);if(("undefined"===typeof k||!k.length||!k[0])&&!h){s=[];for(r in f[l])this.terminals_[r]&&2<r&&s.push("'"+this.terminals_[r]+"'");var u="",u=this.lexer.showPosition?"Parse error on line "+(i+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+s.join(", ")+", got '"+this.terminals_[g]+"'":
"Parse error on line "+(i+1)+": Unexpected "+(1==g?"end of input":"'"+(this.terminals_[g]||g)+"'");this.parseError(u,{text:this.lexer.match,token:this.terminals_[g]||g,line:this.lexer.yylineno,loc:a,expected:s})}if(k[0]instanceof Array&&1<k.length)throw Error("Parse Error: multiple actions possible at state: "+l+", token: "+g);switch(k[0]){case 1:e.push(g);d.push(this.lexer.yytext);c.push(this.lexer.yylloc);e.push(k[1]);g=null;j?(g=j,j=null):(m=this.lexer.yyleng,b=this.lexer.yytext,i=this.lexer.yylineno,
a=this.lexer.yylloc,0<h&&h--);break;case 2:s=this.productions_[k[1]][1];q.$=d[d.length-s];q._$={first_line:c[c.length-(s||1)].first_line,last_line:c[c.length-1].last_line,first_column:c[c.length-(s||1)].first_column,last_column:c[c.length-1].last_column};l=this.performAction.call(q,b,m,i,this.yy,k[1],d,c);if("undefined"!==typeof l)return l;s&&(e=e.slice(0,-2*s),d=d.slice(0,-1*s),c=c.slice(0,-1*s));e.push(this.productions_[k[1]][0]);d.push(q.$);c.push(q._$);k=f[e[e.length-2]][e[e.length-1]];e.push(k);
break;case 3:return!0}}return!0},lexer:{EOF:1,parseError:function(a,e){if(this.yy.parseError)this.yy.parseError(a,e);else throw Error(a);},setInput:function(a){this._input=a;this._more=this._less=this.done=!1;this.yylineno=this.yyleng=0;this.yytext=this.matched=this.match="";this.conditionStack=["INITIAL"];this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0};return this},input:function(){var a=this._input[0];this.yytext+=a;this.yyleng++;this.match+=a;this.matched+=a;a.match(/\n/)&&
this.yylineno++;this._input=this._input.slice(1);return a},unput:function(a){this._input=a+this._input;return this},more:function(){this._more=!0;return this},pastInput:function(){var a=this.matched.substr(0,this.matched.length-this.match.length);return(20<a.length?"...":"")+a.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var a=this.match;20>a.length&&(a+=this._input.substr(0,20-a.length));return(a.substr(0,20)+(20<a.length?"...":"")).replace(/\n/g,"")},showPosition:function(){var a=this.pastInput(),
e=Array(a.length+1).join("-");return a+this.upcomingInput()+"\n"+e+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var a,e;this._more||(this.match=this.yytext="");for(var d=this._currentRules(),c=0;c<d.length;c++)if(a=this._input.match(this.rules[d[c]])){if(e=a[0].match(/\n.*/g))this.yylineno+=e.length;this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:e?e[e.length-1].length-1:this.yylloc.last_column+
a[0].length};this.yytext+=a[0];this.match+=a[0];this.matches=a;this.yyleng=this.yytext.length;this._more=!1;this._input=this._input.slice(a[0].length);this.matched+=a[0];if(a=this.performAction.call(this,this.yy,this,d[c],this.conditionStack[this.conditionStack.length-1]))return a;return}if(""===this._input)return this.EOF;this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var a=this.next();
return"undefined"!==typeof a?a:this.lex()},begin:function(a){this.conditionStack.push(a)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(a){this.begin(a)},performAction:function(a,e,d){switch(d){case 0:"\\"!==e.yytext.slice(-1)&&this.begin("mu");"\\"===e.yytext.slice(-1)&&(e.yytext=e.yytext.substr(0,
e.yyleng-1),this.begin("emu"));if(e.yytext)return 14;break;case 1:return 14;case 2:return this.popState(),14;case 3:return 24;case 4:return 16;case 5:return 20;case 6:return 19;case 7:return 19;case 8:return 23;case 9:return 23;case 10:return e.yytext=e.yytext.substr(3,e.yyleng-5),this.popState(),15;case 11:return 22;case 12:return 34;case 13:return 33;case 14:return 33;case 15:return 36;case 17:return this.popState(),18;case 18:return this.popState(),18;case 19:return e.yytext=e.yytext.substr(1,
e.yyleng-2).replace(/\\"/g,'"'),28;case 20:return 30;case 21:return 30;case 22:return 29;case 23:return 33;case 24:return e.yytext=e.yytext.substr(1,e.yyleng-2),33;case 25:return"INVALID";case 26:return 5}},rules:[/^[^\x00]*?(?=(\{\{))/,/^[^\x00]+/,/^[^\x00]{2,}?(?=(\{\{))/,/^\{\{>/,/^\{\{#/,/^\{\{\//,/^\{\{\^/,/^\{\{\s*else\b/,/^\{\{\{/,/^\{\{&/,/^\{\{![\s\S]*?\}\}/,/^\{\{/,/^=/,/^\.(?=[} ])/,/^\.\./,/^[\/.]/,/^\s+/,/^\}\}\}/,/^\}\}/,/^"(\\["]|[^"])*"/,/^true(?=[}\s])/,/^false(?=[}\s])/,/^[0-9]+(?=[}\s])/,
/^[a-zA-Z0-9_$-]+(?=[=}\s\/.])/,/^\[[^\]]*\]/,/^./,/^$/],conditions:{mu:{rules:[3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26],inclusive:!1},emu:{rules:[2],inclusive:!1},INITIAL:{rules:[0,1,26],inclusive:!0}}}}}();
"undefined"!==typeof require&&"undefined"!==typeof exports&&(exports.parser=handlebars,exports.parse=function(){return handlebars.parse.apply(handlebars,arguments)},exports.main=function(a){if(!a[1])throw Error("Usage: "+a[0]+" FILE");a="undefined"!==typeof process?require("fs").readFileSync(require("path").join(process.cwd(),a[1]),"utf8"):require("file").path(require("file").cwd()).join(a[1]).read({charset:"utf-8"});return exports.parser.parse(a)},"undefined"!==typeof module&&require.main===module&&
exports.main("undefined"!==typeof process?process.argv.slice(1):require("system").args));Handlebars.Parser=handlebars;Handlebars.parse=function(a){Handlebars.Parser.yy=Handlebars.AST;return Handlebars.Parser.parse(a)};Handlebars.print=function(a){return(new Handlebars.PrintVisitor).accept(a)};Handlebars.logger={DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(){}};Handlebars.log=function(a,e){Handlebars.logger.log(a,e)};
(function(){Handlebars.AST={};Handlebars.AST.ProgramNode=function(a,d){this.type="program";this.statements=a;d&&(this.inverse=new Handlebars.AST.ProgramNode(d))};Handlebars.AST.MustacheNode=function(a,d,c){this.type="mustache";this.id=a[0];this.params=a.slice(1);this.hash=d;this.escaped=!c};Handlebars.AST.PartialNode=function(a,d){this.type="partial";this.id=a;this.context=d};var a=function(a,d){if(a.original!==d.original)throw new Handlebars.Exception(a.original+" doesn't match "+d.original);};Handlebars.AST.BlockNode=
function(e,d,c){a(e.id,c);this.type="block";this.mustache=e;this.program=d};Handlebars.AST.InverseNode=function(e,d,c){a(e.id,c);this.type="inverse";this.mustache=e;this.program=d};Handlebars.AST.ContentNode=function(a){this.type="content";this.string=a};Handlebars.AST.HashNode=function(a){this.type="hash";this.pairs=a};Handlebars.AST.IdNode=function(a){this.type="ID";this.original=a.join(".");for(var d=[],c=0,f=0,b=a.length;f<b;f++){var i=a[f];".."===i?c++:"."===i||"this"===i?this.isScoped=!0:d.push(i)}this.parts=
d;this.string=d.join(".");this.depth=c;this.isSimple=1===d.length&&0===c};Handlebars.AST.StringNode=function(a){this.type="STRING";this.string=a};Handlebars.AST.IntegerNode=function(a){this.type="INTEGER";this.integer=a};Handlebars.AST.BooleanNode=function(a){this.type="BOOLEAN";this.bool=a};Handlebars.AST.CommentNode=function(a){this.type="comment";this.comment=a}})();
Handlebars.Exception=function(a){var e=Error.prototype.constructor.apply(this,arguments),d;for(d in e)e.hasOwnProperty(d)&&(this[d]=e[d]);this.message=e.message};Handlebars.Exception.prototype=Error();Handlebars.SafeString=function(a){this.string=a};Handlebars.SafeString.prototype.toString=function(){return this.string.toString()};
(function(){var a={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},e=/&(?!\w+;)|[<>"'`]/g,d=/[&<>"'`]/,c=function(c){return a[c]||"&amp;"};Handlebars.Utils={escapeExpression:function(f){return f instanceof Handlebars.SafeString?f.toString():null==f||!1===f?"":!d.test(f)?f:f.replace(e,c)},isEmpty:function(c){return"undefined"===typeof c?!0:null===c?!0:!1===c?!0:"[object Array]"===Object.prototype.toString.call(c)&&0===c.length?!0:!1}}})();Handlebars.Compiler=function(){};
Handlebars.JavaScriptCompiler=function(){};
(function(a,e){a.OPCODE_MAP={appendContent:1,getContext:2,lookupWithHelpers:3,lookup:4,append:5,invokeMustache:6,appendEscaped:7,pushString:8,truthyOrFallback:9,functionOrFallback:10,invokeProgram:11,invokePartial:12,push:13,assignToHash:15,pushStringParam:16};a.MULTI_PARAM_OPCODES={appendContent:1,getContext:1,lookupWithHelpers:2,lookup:1,invokeMustache:3,pushString:1,truthyOrFallback:1,functionOrFallback:1,invokeProgram:3,invokePartial:1,push:1,assignToHash:1,pushStringParam:1};a.DISASSEMBLE_MAP=
{};for(var d in a.OPCODE_MAP)a.DISASSEMBLE_MAP[a.OPCODE_MAP[d]]=d;a.multiParamSize=function(b){return a.MULTI_PARAM_OPCODES[a.DISASSEMBLE_MAP[b]]};a.prototype={compiler:a,disassemble:function(){for(var b=this.opcodes,c,f=[],d,e=0,l=b.length;e<l;e++)if(c=b[e],"DECLARE"===c)d=b[++e],c=b[++e],f.push("DECLARE "+d+" = "+c);else{d=a.DISASSEMBLE_MAP[c];for(var k=a.multiParamSize(c),q=[],r=0;r<k;r++)c=b[++e],"string"===typeof c&&(c='"'+c.replace("\n","\\n")+'"'),q.push(c);d=d+" "+q.join(" ");f.push(d)}return f.join("\n")},
guid:0,compile:function(b,c){this.children=[];this.depths={list:[]};this.options=c;var f=this.options.knownHelpers;this.options.knownHelpers={helperMissing:!0,blockHelperMissing:!0,each:!0,"if":!0,unless:!0,"with":!0,log:!0};if(f)for(var d in f)this.options.knownHelpers[d]=f[d];return this.program(b)},accept:function(b){return this[b.type](b)},program:function(b){var b=b.statements,c;this.opcodes=[];for(var f=0,d=b.length;f<d;f++)c=b[f],this[c.type](c);this.isSimple=1===d;this.depths.list=this.depths.list.sort(function(b,
c){return b-c});return this},compileProgram:function(b){var b=(new this.compiler).compile(b,this.options),c=this.guid++;this.usePartial=this.usePartial||b.usePartial;this.children[c]=b;for(var f=0,d=b.depths.list.length;f<d;f++)depth=b.depths.list[f],2>depth||this.addDepth(depth-1);return c},block:function(b){var c=b.mustache,f=this.setupStackForMustache(c),d=this.compileProgram(b.program);b.program.inverse&&(b=this.compileProgram(b.program.inverse),this.declare("inverse",b));this.opcode("invokeProgram",
d,f.length,!!c.hash);this.declare("inverse",null);this.opcode("append")},inverse:function(b){var c=this.setupStackForMustache(b.mustache),f=this.compileProgram(b.program);this.declare("inverse",f);this.opcode("invokeProgram",null,c.length,!!b.mustache.hash);this.declare("inverse",null);this.opcode("append")},hash:function(b){var b=b.pairs,c,f;this.opcode("push","{}");for(var d=0,a=b.length;d<a;d++)c=b[d],f=c[1],this.accept(f),this.opcode("assignToHash",c[0])},partial:function(b){var c=b.id;this.usePartial=
!0;b.context?this.ID(b.context):this.opcode("push","depth0");this.opcode("invokePartial",c.original);this.opcode("append")},content:function(b){this.opcode("appendContent",b.string)},mustache:function(b){var c=this.setupStackForMustache(b);this.opcode("invokeMustache",c.length,b.id.original,!!b.hash);b.escaped&&!this.options.noEscape?this.opcode("appendEscaped"):this.opcode("append")},ID:function(b){this.addDepth(b.depth);this.opcode("getContext",b.depth);this.opcode("lookupWithHelpers",b.parts[0]||
null,b.isScoped||!1);for(var c=1,f=b.parts.length;c<f;c++)this.opcode("lookup",b.parts[c])},STRING:function(b){this.opcode("pushString",b.string)},INTEGER:function(b){this.opcode("push",b.integer)},BOOLEAN:function(b){this.opcode("push",b.bool)},comment:function(){},pushParams:function(b){for(var c=b.length,f;c--;)if(f=b[c],this.options.stringParams)f.depth&&this.addDepth(f.depth),this.opcode("getContext",f.depth||0),this.opcode("pushStringParam",f.string);else this[f.type](f)},opcode:function(b,
c,f,d){this.opcodes.push(a.OPCODE_MAP[b]);void 0!==c&&this.opcodes.push(c);void 0!==f&&this.opcodes.push(f);void 0!==d&&this.opcodes.push(d)},declare:function(b,c){this.opcodes.push("DECLARE");this.opcodes.push(b);this.opcodes.push(c)},addDepth:function(b){0!==b&&!this.depths[b]&&(this.depths[b]=!0,this.depths.list.push(b))},setupStackForMustache:function(b){var c=b.params;this.pushParams(c);b.hash&&this.hash(b.hash);this.ID(b.id);return c}};e.prototype={nameLookup:function(b,c){return/^[0-9]+$/.test(c)?
b+"["+c+"]":e.isValidJavaScriptVariableName(c)?b+"."+c:b+"['"+c+"']"},appendToBuffer:function(b){return this.environment.isSimple?"return "+b+";":"buffer += "+b+";"},initializeBuffer:function(){return this.quotedString("")},namespace:"Handlebars",compile:function(c,f,d,a){this.environment=c;this.options=f||{};this.name=this.environment.name;this.isChild=!!d;this.context=d||{programs:[],aliases:{self:"this"},registers:{list:[]}};this.preamble();this.stackSlot=0;this.stackVars=[];this.compileChildren(c,
f);c=c.opcodes;this.i=0;for(b=c.length;this.i<b;this.i++)c=this.nextOpcode(0),"DECLARE"===c[0]?(this.i+=2,this[c[1]]=c[2]):(this.i+=c[1].length,this[c[0]].apply(this,c[1]));return this.createFunctionContext(a)},nextOpcode:function(b){var c=this.environment.opcodes,f=c[this.i+b],d,e;if("DECLARE"===f)return d=c[this.i+1],b=c[this.i+2],["DECLARE",d,b];d=a.DISASSEMBLE_MAP[f];f=a.multiParamSize(f);e=[];for(var l=0;l<f;l++)e.push(c[this.i+l+1+b]);return[d,e]},eat:function(b){this.i+=b.length},preamble:function(){var b=
[];this.useRegister("foundHelper");if(this.isChild)b.push("");else{var c=this.namespace,f="helpers = helpers || "+c+".helpers;";this.environment.usePartial&&(f=f+" partials = partials || "+c+".partials;");b.push(f)}this.environment.isSimple?b.push(""):b.push(", buffer = "+this.initializeBuffer());this.lastContext=0;this.source=b},createFunctionContext:function(b){var c=this.stackVars;this.isChild||(c=c.concat(this.context.registers.list));0<c.length&&(this.source[1]=this.source[1]+", "+c.join(", "));
if(!this.isChild)for(var f in this.context.aliases)this.source[1]=this.source[1]+", "+f+"="+this.context.aliases[f];this.source[1]&&(this.source[1]="var "+this.source[1].substring(2)+";");this.isChild||(this.source[1]+="\n"+this.context.programs.join("\n")+"\n");this.environment.isSimple||this.source.push("return buffer;");c=this.isChild?["depth0","data"]:["Handlebars","depth0","helpers","partials","data"];f=0;for(var d=this.environment.depths.list.length;f<d;f++)c.push("depth"+this.environment.depths.list[f]);
if(b)return c.push(this.source.join("\n  ")),Function.apply(this,c);b="function "+(this.name||"")+"("+c.join(",")+") {\n  "+this.source.join("\n  ")+"}";Handlebars.log(Handlebars.logger.DEBUG,b+"\n\n");return b},appendContent:function(b){this.source.push(this.appendToBuffer(this.quotedString(b)))},append:function(){var b=this.popStack();this.source.push("if("+b+" || "+b+" === 0) { "+this.appendToBuffer(b)+" }");this.environment.isSimple&&this.source.push("else { "+this.appendToBuffer("''")+" }")},
appendEscaped:function(){var b=this.nextOpcode(1),c="";this.context.aliases.escapeExpression="this.escapeExpression";"appendContent"===b[0]&&(c=" + "+this.quotedString(b[1][0]),this.eat(b));this.source.push(this.appendToBuffer("escapeExpression("+this.popStack()+")"+c))},getContext:function(b){this.lastContext!==b&&(this.lastContext=b)},lookupWithHelpers:function(b,c){if(b){var f=this.nextStack();this.usingKnownHelper=!1;!c&&this.options.knownHelpers[b]?(f=f+" = "+this.nameLookup("helpers",b,"helper"),
this.usingKnownHelper=!0):c||this.options.knownHelpersOnly?f=f+" = "+this.nameLookup("depth"+this.lastContext,b,"context"):(this.register("foundHelper",this.nameLookup("helpers",b,"helper")),f=f+" = foundHelper || "+this.nameLookup("depth"+this.lastContext,b,"context"));this.source.push(f+";")}else this.pushStack("depth"+this.lastContext)},lookup:function(b){var c=this.topStack();this.source.push(c+" = ("+c+" === null || "+c+" === undefined || "+c+" === false ? "+c+" : "+this.nameLookup(c,b,"context")+
");")},pushStringParam:function(b){this.pushStack("depth"+this.lastContext);this.pushString(b)},pushString:function(b){this.pushStack(this.quotedString(b))},push:function(b){this.pushStack(b)},invokeMustache:function(b,c,f){this.populateParams(b,this.quotedString(c),"{}",null,f,function(b,c,f){this.usingKnownHelper||(this.context.aliases.helperMissing="helpers.helperMissing",this.context.aliases.undef="void 0",this.source.push("else if("+f+"=== undef) { "+b+" = helperMissing.call("+c+"); }"),b!==
f&&this.source.push("else { "+b+" = "+f+"; }"))})},invokeProgram:function(b,c,f){var d=this.programExpression(this.inverse),b=this.programExpression(b);this.populateParams(c,null,b,d,f,function(b,c){this.usingKnownHelper||(this.context.aliases.blockHelperMissing="helpers.blockHelperMissing",this.source.push("else { "+b+" = blockHelperMissing.call("+c+"); }"))})},populateParams:function(b,c,f,d,a,e){var k=a||this.options.stringParams||d||this.options.data,q=this.popStack(),r=[],s;k?(this.register("tmp1",
f),s="tmp1"):s="{ hash: {} }";k&&(a=a?this.popStack():"{}",this.source.push("tmp1.hash = "+a+";"));this.options.stringParams&&this.source.push("tmp1.contexts = [];");for(k=0;k<b;k++)a=this.popStack(),r.push(a),this.options.stringParams&&this.source.push("tmp1.contexts.push("+this.popStack()+");");d&&(this.source.push("tmp1.fn = tmp1;"),this.source.push("tmp1.inverse = "+d+";"));this.options.data&&this.source.push("tmp1.data = data;");r.push(s);this.populateCall(r,q,c||q,e,"{}"!==f)},populateCall:function(b,
c,f,d,a){var e=["depth0"].concat(b).join(", "),b=["depth0"].concat(f).concat(b).join(", "),f=this.nextStack();this.usingKnownHelper?this.source.push(f+" = "+c+".call("+e+");"):(this.context.aliases.functionType='"function"',this.source.push("if("+(a?"foundHelper && ":"")+"typeof "+c+" === functionType) { "+f+" = "+c+".call("+e+"); }"));d.call(this,f,b,c);this.usingKnownHelper=!1},invokePartial:function(b){params=[this.nameLookup("partials",b,"partial"),"'"+b+"'",this.popStack(),"helpers","partials"];
this.options.data&&params.push("data");this.pushStack("self.invokePartial("+params.join(", ")+");")},assignToHash:function(b){var c=this.popStack(),f=this.topStack();this.source.push(f+"['"+b+"'] = "+c+";")},compiler:e,compileChildren:function(b,c){for(var f=b.children,d,a,e=0,k=f.length;e<k;e++){d=f[e];a=new this.compiler;this.context.programs.push("");var q=this.context.programs.length;d.index=q;d.name="program"+q;this.context.programs[q]=a.compile(d,c,this.context)}},programExpression:function(b){if(null==
b)return"self.noop";for(var c=this.environment.children[b],b=c.depths.list,c=[c.index,c.name,"data"],f=0,d=b.length;f<d;f++)depth=b[f],1===depth?c.push("depth0"):c.push("depth"+(depth-1));if(0===b.length)return"self.program("+c.join(", ")+")";c.shift();return"self.programWithDepth("+c.join(", ")+")"},register:function(b,c){this.useRegister(b);this.source.push(b+" = "+c+";")},useRegister:function(b){this.context.registers[b]||(this.context.registers[b]=!0,this.context.registers.list.push(b))},pushStack:function(b){this.source.push(this.nextStack()+
" = "+b+";");return"stack"+this.stackSlot},nextStack:function(){this.stackSlot++;this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot);return"stack"+this.stackSlot},popStack:function(){return"stack"+this.stackSlot--},topStack:function(){return"stack"+this.stackSlot},quotedString:function(b){return'"'+b.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r")+'"'}};d="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield".split(" ");
for(var c=e.RESERVED_WORDS={},f=0,b=d.length;f<b;f++)c[d[f]]=!0;e.isValidJavaScriptVariableName=function(b){return!e.RESERVED_WORDS[b]&&/^[a-zA-Z_$][0-9a-zA-Z_$]+$/.test(b)?!0:!1}})(Handlebars.Compiler,Handlebars.JavaScriptCompiler);Handlebars.precompile=function(a,e){var e=e||{},d=Handlebars.parse(a),d=(new Handlebars.Compiler).compile(d,e);return(new Handlebars.JavaScriptCompiler).compile(d,e)};
Handlebars.compile=function(a,e){var e=e||{},d;return function(c,f){if(!d){var b=Handlebars.parse(a),b=(new Handlebars.Compiler).compile(b,e),b=(new Handlebars.JavaScriptCompiler).compile(b,e,void 0,!0);d=Handlebars.template(b)}return d.call(this,c,f)}};
Handlebars.VM={template:function(a){var e={escapeExpression:Handlebars.Utils.escapeExpression,invokePartial:Handlebars.VM.invokePartial,programs:[],program:function(d,c,f){var b=this.programs[d];if(f)return Handlebars.VM.program(c,f);b||(b=this.programs[d]=Handlebars.VM.program(c));return b},programWithDepth:Handlebars.VM.programWithDepth,noop:Handlebars.VM.noop};return function(d,c){c=c||{};return a.call(e,Handlebars,d,c.helpers,c.partials,c.data)}},programWithDepth:function(a,e,d){var c=Array.prototype.slice.call(arguments,
2);return function(f,b){b=b||{};return a.apply(this,[f,b.data||e].concat(c))}},program:function(a,e){return function(d,c){c=c||{};return a(d,c.data||e)}},noop:function(){return""},invokePartial:function(a,e,d,c,f,b){options={helpers:c,partials:f,data:b};if(void 0===a)throw new Handlebars.Exception("The partial "+e+" could not be found");if(a instanceof Function)return a(d,options);if(Handlebars.compile)return f[e]=Handlebars.compile(a),f[e](d,options);throw new Handlebars.Exception("The partial "+
e+" could not be compiled when running in runtime-only mode");}};Handlebars.template=Handlebars.VM.template;define("handlebars",function(a){return function(){return a.Handlebars}}(this));
(function(){var a=Handlebars.template,e=Handlebars.templates=Handlebars.templates||{};e.add_site_dialog=a(function(d,c,f){var f=f||d.helpers,b=this.escapeExpression,d='<header class="dialog_header">\n    <h3>\n        <span class="icon icon24 add_site_by_url">\n            <span class="line"></span>\n            <img src="';(f=f.root)?c=f.call(c,{hash:{}}):(c=c.root,c="function"===typeof c?c():c);return d+=b(c)+'img/icon_search_add.png" />\n        </span>\n        <span class="text">Add Site from URL</span>\n    </h3>\n</header>\n<div class="row">\n    <input type="text" name="site-url" id="site-url" class="input_full" placeholder="Enter Site URL" />\n</div>\n<div class="row buttons">\n    <button class="cancel">Cancel</button>\n    <button class="primary" type="submit">Add Site</button>\n</div>\n'});
e.add_sites=a(function(d,c,f,b,a){var f=f||d.helpers,e=this.escapeExpression,h=f.helperMissing,d='<header class="dialog_header">\n    <h3>\n        <span class="icon icon24 add_sites">\n            <span class="line"></span>\n            <img src="';(b=f.root)?b=b.call(c,{hash:{}}):(b=c.root,b="function"===typeof b?b():b);d+=e(b)+'img/icon_search_add.png" />\n        </span>\n        <span class="text">';b=(b=f.add_sites_header)?b.call(c,c,{hash:{}}):h.call(c,"add_sites_header",c,{hash:{}});d+=e(b)+
'</span>\n    </h3>\n</header>\n\n<div class="row">\n    <div class="sites">\n        ';b=c.sites;if((b=f.each.call(c,b,{hash:{},inverse:this.noop,fn:this.program(1,function(b){var c,d,a;c='\n            <div class="site cf" data-id="';(a=f.id)?d=a.call(b,{hash:{}}):(d=b.id,d="function"===typeof d?d():d);c+=e(d)+'">\n                ';d=(a=f.add_sites_icon)?a.call(b,b,{hash:{}}):h.call(b,"add_sites_icon",b,{hash:{}});c+=e(d)+'\n                <span class="text">';d=b.id;d=(a=f.get_site_name)?a.call(b,
d,{hash:{}}):h.call(b,"get_site_name",d,{hash:{}});c+=e(d)+'</span>\n                <span class="icon_sprite remove" data-tip="Remove">\n                    <img class="icon16" src="';(a=f.root)?d=a.call(b,{hash:{}}):(d=b.root,d="function"===typeof d?d():d);return c+=e(d)+'img/icon_minus_w.png" alt="Remove" />\n                </span>\n            </div>\n        '},a)}))||0===b)d+=b;return d+'\n    </div>\n</div>\n<div class="row buttons">\n    <button class="cancel">Cancel</button>\n    <button class="primary" type="submit">Add Search Sites</button>\n</div>\n\n'});
e.alert=a(function(d,c,f){var f=f||d.helpers,b,a=f.helperMissing,e=this.escapeExpression,d='<div class="alert focused"';b=(b=f.alert_data)?b.call(c,c,{hash:{}}):a.call(c,"alert_data",c,{hash:{}});d+=e(b)+">\n\t<h3>";b=(b=f.alert_icon)?b.call(c,c,{hash:{}}):a.call(c,"alert_icon",c,{hash:{}});d+=e(b);b=(b=f.alert_text)?b.call(c,c,{hash:{}}):a.call(c,"alert_text",c,{hash:{}});return d+=e(b)+"</h3>\n</div>"});e.app=a(function(){return'<div id="tooltip"></div>\n<div class="outer">\n    <div class="main">\n        <div id="dialogs"></div> \n        <div id="main_content">\n            <div id="toolbar" class="toolbar"></div>\n            <div id="search_results"></div>\n            <div id="torrent_content" class="list_content"></div>\n        </div>\n    </div>\n    <div id="alerts"></div>\n</div>'});
e.association_dialog=a(function(d,c,f){var f=f||d.helpers,b,a,e=this.escapeExpression,h=f.helperMissing,d='<header class="dialog_header">\n    <h3>\n        <span class="icon icon24 add_site_by_url">\n            <span class="line"></span>\n            <img src="';(a=f.root)?b=a.call(c,{hash:{}}):(b=c.root,b="function"===typeof b?b():b);d+=e(b)+'img/icon_preference_settings.png" />\n        </span>\n        <span class="text">Preferences</span>\n    </h3>\n</header>\n<div class="list_content">\n    <fieldset>\n        <legend>Set Default Torrent Client</legend>\n        <div class="row"> \n            <input type="checkbox" id="set_association" name="associate" ';
b=c.associate;b=(a=f.set_checked)?a.call(c,b,{hash:{}}):h.call(c,"set_checked",b,{hash:{}});d+=e(b)+' />\n            <label for="set_association">Make Surf the default application for .torrent files and magnet links.</label>\n        </div>\n    </fieldset>\n</div>\n<div class="row buttons">\n    <div class="left remember">\n      <input type="checkbox" id="remember_association" name="remember_association" class="js-remember-association" ';b=c.remember_association;b=(a=f.set_checked)?a.call(c,b,
{hash:{}}):h.call(c,"set_checked",b,{hash:{}});return d+=e(b)+' />\n      <label for="remember_association">Remember this setting</label>\n    </div>\n    <button type="submit" class="primary">Continue</button>\n</div>'});e.engines_dialog=a(function(d,c,f){var f=f||d.helpers,b=this.escapeExpression,d='<header class="dialog_header">\n    <h3>\n        <span class="icon icon24">\n            <span class="line"></span>\n            <img src="';(f=f.root)?c=f.call(c,{hash:{}}):(c=c.root,c="function"===
typeof c?c():c);return d+=b(c)+'img/icon_search_settings.png" />\n        </span>\n        <span class="text">Use default search engine in Surf?</span>\n    </h3>\n    <div class="search_options">\n      <input type="radio" name="search_engine_first" value="isohunt.com" />\n      <label>isoHunt</label>\n      <small>(The most advanced BitTorrent search engine)</small>\n    </div>\n    <div class="search_options">\n      <input type="radio" name="search_engine_first" value="google" />\n      <label>Google</label>\n      <small>("torrent" added to searches)</small>\n    </div>\n    <div class="search_options">\n      <input type="radio" name="search_engine_first" value="bing" />\n      <label>Bing</label>\n      <small>("torrent" added to searches)</small>\n    </div>\n    <div class="search_options">\n      <input type="radio" name="search_engine_first" value="yahoo" />\n      <label>Yahoo</label>\n      <small>("torrent" added to searches)</small>\n    </div>\n</header>\n<div class="row buttons">\n    <button class="cancel js-set-default-search" data-default-search="false">Not now</button>\n    <button type="submit" class="primary js-set-default-search" data-default-search="true" data-close-dialog="true">Use Selected</button>\n</div>\n'});
e.genres=a(function(d,c,f,b,a){function e(b){var c;c='\n    <li><a href="#" class="js-link-search genre-search" data-type="/surf:BTFC-';b=typeof b===g?b():b;c+=j(b)+'">';b=typeof b===g?b():b;return c+=j(b)+"</a></li>\n"}var f=f||d.helpers,d="",h,g="function",j=this.escapeExpression,b=f.blockHelperMissing;(h=f.genres)?h=h.call(c,{hash:{},inverse:this.noop,fn:this.program(1,e,a)}):(h=c.genres,h=typeof h===g?h():h);f.genres||(h=b.call(c,h,{hash:{},inverse:this.noop,fn:this.program(1,e,a)}));if(h||0===
h)d+=h;return d+"\n"});e.history=a(function(d,c,f,b,a){function e(b){var c;c='\n    <li><a href="#" class="js-link-search" data-suggestion="';b=typeof b===j?b():b;c+=l(b)+'">';b=typeof b===j?b():b;return c+=l(b)+"</a></li>\n"}function h(){return"\n    <li><a>Empty history.</a></li>\n"}var f=f||d.helpers,g,j="function",l=this.escapeExpression,b=f.blockHelperMissing,d="    <li><h5>Recent Searches</h5></li>\n";(g=f.history)?g=g.call(c,{hash:{},inverse:this.noop,fn:this.program(1,e,a)}):(g=c.history,
g=typeof g===j?g():g);f.history||(g=b.call(c,g,{hash:{},inverse:this.noop,fn:this.program(1,e,a)}));if(g||0===g)d+=g;d+="\n";(g=f.history)?g=g.call(c,{hash:{},inverse:this.program(3,h,a),fn:this.noop}):(g=c.history,g=typeof g===j?g():g);f.history||(g=b.call(c,g,{hash:{},inverse:this.program(3,h,a),fn:this.noop}));if(g||0===g)d+=g;d+="\n";g=c.history;if((g=f["if"].call(c,g,{hash:{},inverse:this.noop,fn:this.program(5,function(){return'\n    <li class="divider"></li>\n    <li><a href="#" class="js-clear-history">Clear recent searches</a></li>\n'},
a)}))||0===g)d+=g;return d});e.notifications_dialog=a(function(d,c,f,b,a){function e(b){var c,d,a;c='\n\t            <li class="';d=b.attributes;d=null==d||!1===d?d:d.type;d=typeof d===h?d():d;c+=g(d)+" ";d=(a=f.resolved_class)?a.call(b,b,{hash:{}}):j.call(b,"resolved_class",b,{hash:{}});c+=g(d)+'">\n\t                ';d=(a=f.notification_icon)?a.call(b,b,{hash:{}}):j.call(b,"notification_icon",b,{hash:{}});c+=g(d)+"\n\t                ";d=(a=f.notification_link)?a.call(b,b,{hash:{}}):j.call(b,"notification_link",
b,{hash:{}});c+=g(d)+'\n\t                <time class="timeago time" datetime="';d=b.timestamp;d=(a=f.iso_date)?a.call(b,d,{hash:{}}):j.call(b,"iso_date",d,{hash:{}});c+=g(d)+'">';(a=f.timestamp)?d=a.call(b,{hash:{}}):(d=b.timestamp,d=typeof d===h?d():d);return c+=g(d)+"</time>\n\t            </li>\n\t        "}var f=f||d.helpers,h="function",g=this.escapeExpression,j=f.helperMissing,l=this,d='<header class="dialog_header">\n    <h3>\n        <span class="icon icon24 add_site_by_url">\n            <span class="line"></span>\n            <img src="';
(b=f.root)?b=b.call(c,{hash:{}}):(b=c.root,b=typeof b===h?b():b);d+=g(b)+'img/icon_notification_settings.png" />\n        </span>\n        <span class="text">Notifications</span>\n    </h3>\n</header>\n<div class="list_content">\n\t';b=c.notifications;if((b=f["if"].call(c,b,{hash:{},inverse:l.program(4,function(){return'\n\t    <ul class="list">\n\t        <li class="message">No notifications.</li>\n\t    </ul>\n\t'},a),fn:l.program(1,function(b,c){var d,a;d='\n\t    <div class="header">\n\t        <span class="column center" style="width: 15%">Type</span>\n\t        <span class="column" style="width: 63%">Event</span>\n\t        <span class="column" style="width: 22%">Time</span>\n\t    </div>\n\t    <ul class="list">\n\t        ';
a=b.notifications;if((a=f.each.call(b,a,{hash:{},inverse:l.noop,fn:l.program(2,e,c)}))||0===a)d+=a;return d+"\n\t    </ul>\n\t"},a)}))||0===b)d+=b;return d+'\n</div>\n<div class="buttons">\n    <button class="cancel right">Done</button>\n</div>\n'});e.remote_asset=a(function(){return'<header class="dialog_header">\n    <h3>\n        <span class="icon icon24 remote_asset_icon">\n            <span class="line"></span>\n            <img src="" />\n        </span>\n        <span class="text"></span>\n    </h3>\n</header>\n<div id="remote_iframe_container"></div>\n<div class="buttons">\n    <button class="cancel right">Done</button>\n</div>\n'});
e.result=a(function(d,c,f,b,a){function e(b,c,d){var a,i;a="\n        ";(i=f.torrent)?i=i.call(b,{hash:{},inverse:n.noop,fn:n.programWithDepth(h,c,d)}):(i=b.torrent,i=typeof i===t?i():i);f.torrent||(i=v.call(b,i,{hash:{},inverse:n.noop,fn:n.programWithDepth(h,c,d)}));if(i||0===i)a+=i;a+="\n        ";(i=f.magnet)?i=i.call(b,{hash:{},inverse:n.noop,fn:n.programWithDepth(j,c,d)}):(i=b.magnet,i=typeof i===t?i():i);f.magnet||(i=v.call(b,i,{hash:{},inverse:n.noop,fn:n.programWithDepth(j,c,d)}));if(i||0===
i)a+=i;return a+"\n    "}function h(b,c,d){var a,e;a='\n            <li>\n                <div class="line"></div>\n                <a href="';b=typeof b===t?b():b;a+=p(b)+'" class="download torrent ';e=d.downloaded;e=typeof e===t?e():e;if((e=e=v.call(b,e,{hash:{},inverse:n.noop,fn:n.program(7,g,c)}))||0===e)a+=e;a+='" data-id="';e=d.torrent;e=null==e||!1===e?e:e.url;e=typeof e===t?e():e;a+=p(e)+'">\n                    <img class="icon16 dl_arrow" src="';(c=f.root)?e=c.call(b,{hash:{}}):(e=b.root,
e=typeof e===t?e():e);a+=p(e)+'img/icon_download_w.png" alt="Download" data-tip="';e=(c=f.get_download_link_tip)?c.call(b,d,{hash:{}}):u.call(b,"get_download_link_tip",d,{hash:{}});a+=p(e)+'" />\n                    <img class="icon16 check" src="';(c=f.root)?e=c.call(b,{hash:{}}):(e=b.root,e=typeof e===t?e():e);return a+=p(e)+'img/icon_check_w.png" alt="Downloading" data-tip="Downloading" />\n                </a>\n            </li>\n        '}function g(){return"downloading"}function j(b,c,d){var a,
e;a='\n            <li>\n                <div class="line"></div>\n                <a href="';b=typeof b===t?b():b;a+=p(b)+'" class="download magnet ';e=d.downloaded;e=typeof e===t?e():e;if((e=e=v.call(b,e,{hash:{},inverse:n.noop,fn:n.program(10,l,c)}))||0===e)a+=e;a+='" data-id="';e=d.torrent;e=null==e||!1===e?e:e.url;e=typeof e===t?e():e;a+=p(e)+'">\n                    <img class="icon16 dl_arrow" src="';(c=f.root)?e=c.call(b,{hash:{}}):(e=b.root,e=typeof e===t?e():e);a+=p(e)+'img/icon_download_w.png" alt="Magnet" data-tip="';
e=(c=f.get_download_link_tip)?c.call(b,d,{hash:{}}):u.call(b,"get_download_link_tip",d,{hash:{}});a+=p(e)+'" />\n                    <img class="icon16 check" src="';(c=f.root)?e=c.call(b,{hash:{}}):(e=b.root,e=typeof e===t?e():e);return a+=p(e)+'img/icon_check_w.png" alt="Downloading" data-tip="Downloading" />\n                </a>\n            </li>\n        '}function l(){return"downloading"}function k(b,c,d){var a,e;a="\n    ";e=d.duplicates;if((e=f["if"].call(b,e,{hash:{},inverse:n.programWithDepth(r,
c,d),fn:n.programWithDepth(q,c,d)}))||0===e)a+=e;return a+"\n"}function q(b,c,d){var a,c='\n        <span class="title js-toggle-expandable" data-tip="';a=(a=f.get_title_tip)?a.call(b,d,{hash:{}}):u.call(b,"get_title_tip",d,{hash:{}});c+=p(a)+'">';a=(a=f.get_result_name)?a.call(b,d,{hash:{}}):u.call(b,"get_result_name",d,{hash:{}});return c+=p(a)+"</span>\n    "}function r(b,c,d){var a,c='\n        <span class="title" data-tip="';a=(a=f.get_title_tip)?a.call(b,d,{hash:{}}):u.call(b,"get_title_tip",
d,{hash:{}});c+=p(a)+'">';a=(a=f.get_result_name)?a.call(b,d,{hash:{}}):u.call(b,"get_result_name",d,{hash:{}});return c+=p(a)+"</span>\n    "}function s(b,c,d){var a,e,c='\n        <li>\n            <a class="js-open-tab" data-tip="';a=(e=f.get_tab_link_tip)?e.call(b,b,{hash:{}}):u.call(b,"get_tab_link_tip",b,{hash:{}});c+=p(a)+'" href="';a=b.torrent;a=null==a||!1===a?a:a.url;a=typeof a===t?a():a;c+=p(a)+'">\n                <img src="';a=b.favicon;a=(e=f.getFavicon)?e.call(b,a,{hash:{}}):u.call(b,
"getFavicon",a,{hash:{}});c+=p(a)+'" alt="" class="icon16 favicon"/>\n            </a>\n            <span class="title" data-tip="';a=(e=f.get_title_tip)?e.call(b,d,{hash:{}}):u.call(b,"get_title_tip",d,{hash:{}});c+=p(a)+'">';a=b.torrent;a=null==a||!1===a?a:a.name;a=typeof a===t?a():a;return c+=p(a)+"</span>\n        </li>\n        "}var f=f||d.helpers,d="",u=f.helperMissing,p=this.escapeExpression,t="function",n=this,v=f.blockHelperMissing,b=c.duplicates;if((b=f["if"].call(c,b,{hash:{},inverse:n.program(3,
function(b){var c,a,d;c='\n    <a class="js-open-tab" data-tip="';a=(d=f.get_tab_link_tip)?d.call(b,b,{hash:{}}):u.call(b,"get_tab_link_tip",b,{hash:{}});c+=p(a)+'" href="';a=b.torrent;a=null==a||!1===a?a:a.url;a=typeof a===t?a():a;c+=p(a)+'"><img src="';a=b.favicon;a=(d=f.getFavicon)?d.call(b,a,{hash:{}}):u.call(b,"getFavicon",a,{hash:{}});return c+=p(a)+'" alt="" class="icon16 favicon"/></a>\n'},a),fn:n.program(1,function(){return'\n    <div class="arrow js-toggle-expandable"></div>\n'},a)}))||
0===b)d+=b;d+='\n\n    <div class="col size right">\n        <span class="size">';b=(b=f.get_result_size)?b.call(c,c,{hash:{}}):u.call(c,"get_result_size",c,{hash:{}});d+=p(b)+"</span>\n    </div>\n\n    ";b=(b=f.scrape_health)?b.call(c,c,{hash:{}}):u.call(c,"scrape_health",c,{hash:{}});d+=p(b)+'\n\n    <ul class="downloads">\n    ';(b=f.download)?b=b.call(c,{hash:{},inverse:n.noop,fn:n.programWithDepth(e,a,c)}):(b=c.download,b=typeof b===t?b():b);f.download||(b=v.call(c,b,{hash:{},inverse:n.noop,
fn:n.programWithDepth(e,a,c)}));if(b||0===b)d+=b;d+="\n    </ul>\n\n";(b=f.torrent)?b=b.call(c,{hash:{},inverse:n.noop,fn:n.programWithDepth(k,a,c)}):(b=c.torrent,b=typeof b===t?b():b);f.torrent||(b=v.call(c,b,{hash:{},inverse:n.noop,fn:n.programWithDepth(k,a,c)}));if(b||0===b)d+=b;d+="\n\n";b=c.duplicates;if((b=f["if"].call(c,b,{hash:{},inverse:n.noop,fn:n.programWithDepth(function(b,c,a){var d,e,i;d='\n    <ul class="duplicates">\n        <li>\n            <a class="js-open-tab" data-tip="';e=(i=
f.get_tab_link_tip)?i.call(b,b,{hash:{}}):u.call(b,"get_tab_link_tip",b,{hash:{}});d+=p(e)+'" href="';e=b.torrent;e=null==e||!1===e?e:e.url;e=typeof e===t?e():e;d+=p(e)+'">\n                <img src="';e=a.favicon;e=(i=f.getFavicon)?i.call(b,e,{hash:{}}):u.call(b,"getFavicon",e,{hash:{}});d+=p(e)+'" alt="" class="icon16 favicon"/>\n            </a>\n            <span class="title" data-tip="';e=(i=f.get_title_tip)?i.call(b,a,{hash:{}}):u.call(b,"get_title_tip",a,{hash:{}});d+=p(e)+'">';e=a.torrent;
e=null==e||!1===e?e:e.name;e=typeof e===t?e():e;d+=p(e)+"</span>\n        </li>\n        ";(i=f.duplicates)?e=i.call(b,{hash:{},inverse:n.noop,fn:n.programWithDepth(s,c,b)}):(e=b.duplicates,e=typeof e===t?e():e);f.duplicates||(e=v.call(b,e,{hash:{},inverse:n.noop,fn:n.programWithDepth(s,c,b)}));if(e||0===e)d+=e;return d+"\n    </ul>\n"},a,c)}))||0===b)d+=b;return d});e.search=a(function(){return'<div id="suggestion"></div>\n<div class="search_content">\n\t<div class="header">\n\t    <div class="column site">Site</div>\n\t    <div class="column name">Name</div>\n\t    <div class="column size">Size</div>\n\t    <div class="column result_health">Health</div>\n\t    <div class="column link">Link</div>\n\t</div>\n\t<ul class="content can-expand">\n\t    <li class="message" id="no_results">Empty list.</li>\n\t</ul>\n\t<div class="alert_container"></div>\n</div>'});
e.settings_dialog=a(function(a,c,f){var f=f||a.helpers,b=this.escapeExpression,a='<header class="dialog_header">\n    <h3>\n        <span class="icon icon24 add_site_by_url">\n            <span class="line"></span>\n            <img src="';(f=f.root)?c=f.call(c,{hash:{}}):(c=c.root,c="function"===typeof c?c():c);return a+=b(c)+'img/icon_preference_settings.png" />\n        </span>\n        <span class="text">Preferences</span>\n    </h3>\n</header>\n<div class="list_content">\n    <fieldset>\n        <legend>Download folder</legend>\n        <div class="row"> \n            <input type="text" id="dir_active_download" name="dir_active_download" class="js-select-download-dir" placeholder="User\'s Downloads Folder" style="width: 75%" readonly />\n            <button class="js-select-download-dir">Browse&hellip;</button>\n        </div>\n    </fieldset>\n\n    <fieldset>\n        <legend>Sharing</legend>\n        <div class="row">\n            <div class="col half seed-option" id="seed_time_options">\n                <div class="row">\n                    <label>Share time: <b><span id="seed_time_text">10 minutes</span></b></label>\n                </div>\n                <div class="row">\n                    <input type="range" min="0" max="370" step="10" value="10" id="seed_time" name="seed_time" />\n                </div>\n            </div>\n\n            <div class="col half hidden seed-option" id="seed_percentage_options">\n                <div class="row">\n                    <label>Share percentage: <b><span id="seed_percentage_text">200%</span></b></label>\n                </div>\n                <div class="row">\n                    <input type="range" min="0" max="400" step="10" value="200" id="seed_percentage" name="seed_percentage" />\n                </div>\n            </div>\n            \n            <div class="col half">\n                <div class="row">\n                    <input type="radio" name="seed_type" value="time" id="seed_type_time" checked="checked" data-options="seed_time_options" />\n                    <label for="seed_type_time">Share for specified time</label>\n                </div>\n                <div class="row">\n                    <input type="radio" name="seed_type" value="percentage" id="seed_type_percentage" data-options="seed_percentage_options" />\n                    <label for="seed_type_percentage">Share for % of size</label>\n                </div>\n            </div>\n        </div>\n    </fieldset>\n\n    <fieldset>\n        <legend>Torrent Association</legend>\n        <div class="row"> \n            <input type="checkbox" id="set_association_setting" name="associate" />\n            <label for="set_association_setting">Use Surf to open .torrent files and magnet links.</label>\n        </div>\n    </fieldset>\n</div>\n<div class="buttons">\n    <button class="cancel right">Done</button>\n</div>\n'});
e.site_manager=a(function(a,c,f,b,e){function m(b,c){var a,d,e;a='\n            <li class="';(e=f.type)?d=e.call(b,{hash:{}}):(d=b.type,d=typeof d===j?d():d);a+=l(d)+" ";(e=f.id)?d=e.call(b,{hash:{}}):(d=b.id,d=typeof d===j?d():d);a+=l(d)+'">\n                <img src="';(e=f.favicon)?d=e.call(b,{hash:{}}):(d=b.favicon,d=typeof d===j?d():d);a+=l(d)+'" alt="" class="icon16 favicon"/>\n                <input type="checkbox" id="site_';(e=f.id)?d=e.call(b,{hash:{}}):(d=b.id,d=typeof d===j?d():d);a+=
l(d)+'" data-id="';(e=f.id)?d=e.call(b,{hash:{}}):(d=b.id,d=typeof d===j?d():d);a+=l(d)+'" class="switch_input js-toggle-site" ';d=b.enabled;if((d=f["if"].call(b,d,{hash:{},inverse:k.noop,fn:k.program(2,h,c)}))||0===d)a+=d;a+=' />\n                <div class="switch ';d=(e=f.site_enabled)?e.call(b,b,{hash:{}}):q.call(b,"site_enabled",b,{hash:{}});a+=l(d)+'"></div>        \n                <label for="site_';(e=f.id)?d=e.call(b,{hash:{}}):(d=b.id,d=typeof d===j?d():d);a+=l(d)+'">';d=b.id;d=(e=f.get_site_name)?
e.call(b,d,{hash:{}}):q.call(b,"get_site_name",d,{hash:{}});return a+=l(d)+"</label>\n            </li>\n        "}function h(){return'checked="checked"'}var f=f||a.helpers,g,j="function",l=this.escapeExpression,k=this,q=f.helperMissing,b=f.blockHelperMissing,a='<header class="dialog_header">\n    <h3>\n        <span class="icon icon24 add_site_by_url">\n            <span class="line"></span>\n            <img src="';(g=f.root)?g=g.call(c,{hash:{}}):(g=c.root,g=typeof g===j?g():g);a+=l(g)+'img/icon_search_settings.png" />\n        </span>\n        <span class="text">Search Settings</span>\n    </h3>\n</header>\n<div class="list_content">\n    <ul class="list can-expand">\n        <li class="expandable default_engines">\n            <div class="arrow js-toggle-expandable"></div>\n            <input type="checkbox" class="switch_input js-toggle-site" name="search_default" id="search_default" data-id="search_default" />\n            <div class="switch"></div>\n\n            <label for="search_engine">Default Search Site <small>("torrent" added to searches.)</small></label>\n            \n            <ul class="engines sub">\n                <li>\n                    <input type="radio" name="search_engine" value="isohunt.com" /><label>isoHunt</label>\n                </li>\n                <li>\n                    <input type="radio" name="search_engine" value="google" /><label>Google</label>\n                </li>\n                <li>\n                    <input type="radio" name="search_engine" value="bing" /><label>Bing</label>\n                </li>\n                <li>\n                    <input type="radio" name="search_engine" value="yahoo" /><label>Yahoo</label>\n                </li>\n            </ul>\n        </li>\n        ';
(g=f.sites)?g=g.call(c,{hash:{},inverse:k.noop,fn:k.program(1,m,e)}):(g=c.sites,g=typeof g===j?g():g);f.sites||(g=b.call(c,g,{hash:{},inverse:k.noop,fn:k.program(1,m,e)}));if(g||0===g)a+=g;return a+'        \n    </ul>\n</div>\n\n<div class="buttons">\n    <button class="left js-open-dialog" data-dialog="add_site">Add Site from URL</button>\n    <button class="cancel right">Done</button>\n</div>'});e.suggestion=a(function(a,c,f,b,e){function m(b){var c,a;c='\n\t\t\t    \t<li><a href="#" class="js-genre-search" data-type="/surf:BTFC-';
a=(a=f.capitalize)?a.call(b,b,{hash:{}}):g.call(b,"capitalize",b,{hash:{}});c+=h(a)+'">';a=(a=f.capitalize)?a.call(b,b,{hash:{}}):g.call(b,"capitalize",b,{hash:{}});return c+=h(a)+"</a></li>\n\t\t\t\t"}var f=f||a.helpers,h=this.escapeExpression,g=f.helperMissing,j=this,a='<div class="suggestion">\n\t',b=c.spelling;if((b=f["if"].call(c,b,{hash:{},inverse:j.program(3,function(b,c){var a,d;a='\n\t\t<span id="label">You might like: </span>\n\t\t<a href="#" data-suggestion="';d=b.model;d=null==d||!1===
d?d:d.torrent;d=null==d||!1===d?d:d.name;d="function"===typeof d?d():d;a+=h(d)+'" class="js-link-search text">';d=b.model;d=null==d||!1===d?d:d.torrent;d=null==d||!1===d?d:d.name;d="function"===typeof d?d():d;a+=h(d)+'</a>\n\n\t\t<div class="more">More: \n\t\t\t<a href="#" data-type="/surf:BTFC-';d=(d=f.get_first_genre)?d.call(b,b,{hash:{}}):g.call(b,"get_first_genre",b,{hash:{}});a+=h(d)+'" class="js-genre-search">';d=(d=f.get_first_genre_capitalized)?d.call(b,b,{hash:{}}):g.call(b,"get_first_genre_capitalized",
b,{hash:{}});a+=h(d)+'</a>\n\t\t\t<a href="#" class="arrow icon16 js-toggle-menu hidden"></a>\n\t\t    <ul class="menu hidden">\n\t\t\t\t';d=b.model;d=null==d||!1===d?d:d.recommended_genres;if((d=f.each.call(b,d,{hash:{},inverse:j.noop,fn:j.program(4,m,c)}))||0===d)a+=d;return a+"\n\t\t    </ul>\n\t\t</div>\n\t"},e),fn:j.program(1,function(b){var c,a;c='\n\t\t<span id="label">Did you mean: </span>\n\t\t<a href="#" data-suggestion="';(a=f.spelling)?a=a.call(b,{hash:{}}):(a=b.spelling,a="function"===
typeof a?a():a);c+=h(a)+'" class="js-link-search text">';(a=f.spelling)?a=a.call(b,{hash:{}}):(a=b.spelling,a="function"===typeof a?a():a);return c+=h(a)+"</a>\n\t"},e)}))||0===b)a+=b;return a+"\n</div>"});e.toolbar=a(function(a,c,f){var f=f||a.helpers,b,e=this.escapeExpression,a='<div class="search_container">\n    <div id="search_history">\n        <a href="#" class="arrow icon16 js-toggle-menu">Search History</a>\n\n        <ul class="hidden menu">\n            <li>Empty list.</li>\n        </ul>\n    </div>\n    <div id="do-search">\n        <button class="search_icon" type="submit">Search</button>\n        <input type="text" name="search_text" id="search_text" placeholder="Search for stuff" />\n    </div>\n    <div id="add_site_button">\n        <button class="js-open-dialog" data-dialog="site_manager">Add Search Site</button>\n    </div>\n\n</div>\n\n<ul class="buttons">\n    <li>\n        <a class="js-open-dialog" data-dialog="notifications" href="#notifications-view" data-tip="Notifications">\n            <span class="notifications">\n                <img src="';
(b=f.root)?b=b.call(c,{hash:{}}):(b=c.root,b="function"===typeof b?b():b);a+=e(b)+'img/icon_notification_settings.png" class="icon20" />\n            </span>\n            <span id="notifications-badge" data-ct="0"></span>\n        </a>\n    </li>\n    <li>\n        <a class="js-open-dialog" data-dialog="site_manager" href="#search_settings" data-tip="Search Settings">\n            <span class="site_manager">\n                <img src="';(b=f.root)?b=b.call(c,{hash:{}}):(b=c.root,b="function"===typeof b?
b():b);return a+=e(b)+'img/icon_search_settings.png" class="icon20" />\n            </span>\n        </a>\n    </li>\n</ul>'});e.torrent=a(function(a,c,f){var f=f||a.helpers,b,e=f.helperMissing,m=this.escapeExpression,a='<div class="row" data-tip="';b=(b=f.get_torrent_tip)?b.call(c,c,{hash:{}}):e.call(c,"get_torrent_tip",c,{hash:{}});a+=m(b)+'">\n    <div class="col download">\n        <h2>';b=c.properties;b=null==b||!1===b?b:b.name;b="function"===typeof b?b():b;a+=m(b)+'</h2>\n    </div>\n    <div class="col status right">\n        <span class="eta">';
b=(b=f.get_eta)?b.call(c,c,{hash:{}}):e.call(c,"get_eta",c,{hash:{}});a+=m(b)+'</span>\n        <span class="eq" data-tip="';b=(b=f.get_eq_tip)?b.call(c,c,{hash:{}}):e.call(c,"get_eq_tip",c,{hash:{}});a+=m(b)+'">\n            <span class="down left">\n                <span class="icon eq_sprite ';b=(b=f.get_class_down)?b.call(c,c,{hash:{}}):e.call(c,"get_class_down",c,{hash:{}});a+=m(b)+'"></span>\n            </span>\n            <span class="up right">\n                <span class="icon eq_sprite ';
b=(b=f.get_class_up)?b.call(c,c,{hash:{}}):e.call(c,"get_class_up",c,{hash:{}});a+=m(b)+'"></span>\n            </span>\n        </span>\n    </div>\n    <div class="col size right">\n        <span class="size" data-tip="';b=(b=f.get_downloaded_size)?b.call(c,c,{hash:{}}):e.call(c,"get_downloaded_size",c,{hash:{}});a+=m(b)+'">';b=(b=f.get_total_size)?b.call(c,c,{hash:{}}):e.call(c,"get_total_size",c,{hash:{}});a+=m(b)+'</span>\n    </div>\n    <div class="col options">\n        ';b=(b=f.get_active_health)?
b.call(c,c,{hash:{}}):e.call(c,"get_active_health",c,{hash:{}});a+=m(b)+'\n        <span class="icon_sprite remove" data-tip="Remove Download"><img class="icon16" alt="remove" src="';(b=f.root)?b=b.call(c,{hash:{}}):(b=c.root,b="function"===typeof b?b():b);a+=m(b)+'img/icon_delete_w.png" /></span>\n        <span class="icon_sprite pause" data-tip="Pause Download"><img class="icon16" alt="pause" src="';(b=f.root)?b=b.call(c,{hash:{}}):(b=c.root,b="function"===typeof b?b():b);a+=m(b)+'img/icon_pause_w.png" /></span>\n        <span class="icon_sprite start" data-tip="Resume Download"><img class="icon16" alt="download" src="';
(b=f.root)?b=b.call(c,{hash:{}}):(b=c.root,b="function"===typeof b?b():b);a+=m(b)+'img/icon_download_w.png" /></span>\n        <span class="icon_sprite open" data-tip="Open Download\'s Folder"><img class="icon16" alt="open" src="';(b=f.root)?b=b.call(c,{hash:{}}):(b=c.root,b="function"===typeof b?b():b);a+=m(b)+'img/icon_download_folder.png" /></span>\n    </div>\n</div>\n<div class="row progress_bar">\n    <div class="col full">\n        <div class="progress">\n            <div class="track"></div>\n            <div class="bar" style="width: ';
b=(b=f.get_progress)?b.call(c,c,{hash:{}}):e.call(c,"get_progress",c,{hash:{}});return a+=m(b)+'%"></div>\n        </div>\n    </div>\n</div>\n'});e.torrents=a(function(){return'<div class="header">\n    <div class="column download">Downloads</div>\n    <div class="column status">Status</div>\n    <div class="column size">Size</div>\n    <div class="column torrent_health">Options</div>\n\n    <div id="download_settings">\n        <a href="#" class="arrow icon16 js-toggle-menu" data-tip="Open Settings">Torrent Settings</a>\n        \n        <ul class="hidden menu">\n            <li class="js-open-dialog" data-dialog="settings" href="#settings">Set Download Options</li>\n            <li class="js-menu-action" data-action="clear_completed_downloads">Clear Completed Downloads</li>\n        </ul>\n    </div>  \n</div>\n\n<\!-- Displayed when NO torrents are downloading/seeding --\>\n<div class="message" id="no_torrents">Empty list.</div>\n\n<\!-- Displayed when torrents are downloading/seeding --\>\n<ul id="torrents"></ul>\n\n<div class="alert_container"></div>'})})();
define("templates",["handlebars"],function(){});
(function(a){function e(){var f;f=a(this);if(!f.data("timeago")){f.data("timeago",{datetime:c.datetime(f)});var b=a.trim(f.text());0<b.length&&(!c.isTime(f)||!f.attr("title"))&&f.attr("title",b)}f=f.data("timeago");isNaN(f.datetime)||a(this).text(d(f.datetime));return this}function d(a){return c.inWords((new Date).getTime()-a.getTime())}a.timeago=function(c){return c instanceof Date?d(c):"string"===typeof c?d(a.timeago.parse(c)):"number"===typeof c?d(new Date(c)):d(a.timeago.datetime(c))};var c=a.timeago;
a.extend(a.timeago,{settings:{refreshMillis:6E4,allowFuture:!1,strings:{prefixAgo:null,prefixFromNow:null,suffixAgo:"ago",suffixFromNow:"from now",seconds:"Just now",minute:"1 minute",minutes:"%d minutes",hour:"1 hour",hours:"%d hours",day:"a day",days:"%d days",month:"1 month",months:"%d months",year:"1 year",years:"%d years",wordSeparator:" ",numbers:[]}},inWords:function(c){function b(b,e){return(a.isFunction(b)?b(e,c):b).replace(/%d/i,d.numbers&&d.numbers[e]||e)}var d=this.settings.strings,e=
d.prefixAgo,h=d.suffixAgo;this.settings.allowFuture&&0>c&&(e=d.prefixFromNow,h=d.suffixFromNow);var g=Math.abs(c)/1E3,j=g/60,l=j/60,k=l/24,q=k/365,j=45>g&&b(d.seconds,Math.round(g))||90>g&&b(d.minute,1)||45>j&&b(d.minutes,Math.round(j))||90>j&&b(d.hour,1)||24>l&&b(d.hours,Math.round(l))||42>l&&b(d.day,1)||30>k&&b(d.days,Math.round(k))||45>k&&b(d.month,1)||365>k&&b(d.months,Math.round(k/30))||1.5>q&&b(d.year,1)||b(d.years,Math.round(q));45>g&&(h="");return a.trim([e,j,h].join(void 0===d.wordSeparator?
" ":d.wordSeparator))},parse:function(c){c=a.trim(c);c=c.replace(/\.\d+/,"");c=c.replace(/-/,"/").replace(/-/,"/");c=c.replace(/T/," ").replace(/Z/," UTC");c=c.replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2");return new Date(c)},datetime:function(d){d=c.isTime(d)?a(d).attr("datetime"):a(d).attr("title");return c.parse(d)},isTime:function(c){return"time"===a(c).get(0).tagName.toLowerCase()}});a.fn.timeago=function(){var a=this;a.each(e);var b=c.settings;0<b.refreshMillis&&setInterval(function(){a.each(e)},
b.refreshMillis);return a};document.createElement("abbr");document.createElement("time")})(jQuery);define("timeago",["jquery"],function(){});
(function(){define("app.view",["require","handlebars","backbone","sandbox_helpers","config"],function(a,e){a("config");var d=a("sandbox_helpers"),c,f=Backbone.View.extend({el:"body",events:{"click .js-toggle-expandable":"toggle_expandable","click .js-open-dialog":"open_dialog","click .js-link-search":"link_search","click .js-genre-search":"link_genre_search","click .js-toggle-menu":"toggle_menu","click .js-open-tab":"open_tab","click .js-menu-action":"on_menu_action_click"},initialize:function(b){c=
_sandbox.tabs;c.init();this.app=b.app;this.menu_actions={clear_completed_downloads:_.bind(this.on_clear_completed_downloads,this)};this.bind_events();this.render()},bind_events:function(){this.el.addEventListener("keydown",_.bind(this.on_key_up_down,this));this.el.addEventListener("keyup",_.bind(this.on_key_up_down,this));this.el.addEventListener("mouseover",_.bind(this.on_mouseover,this));this.el.addEventListener("mouseout",_.bind(this.on_mouseout,this))},on_menu_action_click:function(b){b=$(b.currentTarget).data().action;
this.menu_actions[b]();d.track("menu","click",b,null)},on_clear_completed_downloads:function(){_.each(this.app.views.torrents.torrent_views,function(b){b.$el.hasClass("completed")&&b.$el.find(".remove").trigger("click")})},on_key_up_down:function(b){this.app._metaKey_down=b.metaKey;this.app._ctrlKey_down=b.ctrlKey;this.app._shiftKey_down=b.shiftKey;if((this.app._metaKey_down||this.app._ctrlKey_down)&&this.app._shiftKey_down)85===b.which?_sandbox.extension_tabs.open({name:"popup"}):220===b.which&&
this.app.torque_settings.open_webui()},open_dialog:function(b){b.preventDefault();b=$(b.currentTarget).data("dialog");this.app.views.dialogs.open(b)},toggle_expandable:function(b){b.preventDefault();$(b.currentTarget).closest(".expandable").toggleClass("open");this.app.trigger("render")},toggle_menu:function(b){b.preventDefault();var c=this,b=$(b.currentTarget),a=b.siblings(".menu"),f="hide";a.hasClass("hidden")&&(f="show",$("body").one("click",function(){c.hide_menu(a)}));a.toggleClass("hidden");
d.track("menu",f,b.parent().attr("id"),null)},hide_menu:function(b){$(b).addClass("hidden")},open_tab:function(b){b.preventDefault();b=$(b.currentTarget).attr("href");this.app._ctrlKey_down||this.app._metaKey_down?c.open(b,!1,!1):c.open(b,!0,!0)},link_search:function(b){b.preventDefault();var b=$(b.currentTarget),c=b.data("suggestion");$("#search_text").val(c);b=b.closest(".suggestion");b.length&&b.hasClass("recommendation")?d.track("recommendation","name_click",null,null):d.track("menu","link_search",
!b.length?"search_history":"spell_check",null);this.app.views.toolbar.submit_search(!0)},link_genre_search:function(b){b.preventDefault();b=$(b.currentTarget).data("type");$("#search_text").val(b);d.track("recommendation","genre_click",null,null);this.app.views.toolbar.submit_search(!0)},find_tip:function(b,c){var a=0,d=function(){a++;return this.dataset.tip?{el:this,tip:this.dataset.tip}:a<=c&&this.parentElement?d.call(this.parentElement):!1};return d.call(b)},on_mouseover:function(b){var c=this.find_tip(b.target,
5);c&&this.app.trigger("tip:show",c.tip,$(c.el).offset(),b)},on_mouseout:function(){this.app.trigger("tip:hide")},render:function(){var b=e.templates.app();this.$el.html(b);this.app.trigger("render")}});_.each({root:function(){return _config.data_path+"app/"}},function(b,c){e.registerHelper(c,b)});return f})})();
(function(){define("tip.view",["require","backbone"],function(){return Backbone.View.extend({el:"#tooltip",events:{},initialize:function(a){this.app=a.app;delete a.app;this.bind_events()},bind_events:function(){this.app.on("tip:show",this.on_tip_show,this);this.app.on("tip:hide",this.on_tip_hide,this)},position:function(a){var e=this.app.views.app.$el.outerWidth(),d=this.app.views.app.$el.outerHeight(),c=this.$el.outerWidth(),f=this.$el.outerHeight(),b=0,i=0,i=a.left+c+16<e?a.left+16:a.left-c+16,
b=a.top+f+24<d?a.top+24:a.top-f;this.$el.css({top:b,left:i})},timeout:null,delay_time:500,is_showing:!1,on_tip_show:function(a,e){clearTimeout(this.timeout);this.timeout=setTimeout(_.bind(function(){this.$el.html(a);this.position(e);this.$el.show();this.is_showing=!0},this),this.delay_time)},on_tip_hide:function(){this.timeout&&clearTimeout(this.timeout);this.is_showing&&this.$el.hide().css({top:0,left:0})},render:function(){}})})})();
(function(){define("toolbar.view",["require","handlebars","backbone","sandbox_helpers"],function(a,e){var d=a("sandbox_helpers");return Backbone.View.extend({el:"#toolbar",$search_button:null,search_history:[],$search_history:null,events:{"click #do-search button":"on_search_submit","keypress #do-search input":"on_search_keypress","input #do-search input":"on_search_input","click .js-clear-history":"clear_history"},initialize:function(c){this.app=c.app;this.bind_events();this.render();this.$search_history=
this.$el.find("#search_history > ul");this.$search_button=this.$el.find("#do-search button");this.$notifications_badge=this.$el.find("#notifications-badge");this.on_history();this.set_searching_indicator(this.collection._searching)},bind_events:function(){this.app.collections.notifications.on("reset",this.on_notifications_reset,this);this.app.collections.sites.on("reset",this.check_can_search,this);this.app.on("dialog:close",this.on_dialog_close,this);this.collection.on("searching",this.set_searching_indicator,
this);this.collection.on("cached",this.set_cached_indicator,this);this.collection.on("reset",this.on_search_reset,this);this.collection.on("history",this.on_history,this)},on_search_reset:function(){this.$el.find("#do-search input").val(this.collection._last_query)},on_notifications_reset:function(){var c=this.app.collections.notifications._raw_unresolved_length,c=9<c?"9+":c;this.$notifications_badge.attr({"data-ct":c}).text(c)},on_search_keypress:function(c){13===c.which&&(d.track("toolbar","submit",
"keypress",!this.app._shiftKey_down?0:1),this.submit_search(!this.app._shiftKey_down))},on_search_input:function(c){c=$(c.currentTarget).val();this.$search_button.toggleClass("download",this.is_download_link(c));this.$search_button.toggleClass("command",this.is_potential_command(c))},on_dialog_close:function(){this.$el.find("#do-search input").trigger("input")},check_can_search:function(){var c=this.app.collections.sites.where({type:"added"});this.$el.toggleClass("no-sites",!c.length)},on_search_submit:function(){this.submit_search(!1);
d.track("toolbar","submit","button",!1)},submit_search:function(c){var a=$("#search_text").val();this.is_download_link(a)?(d.track("toolbar","attempt-add-torrent",null,null),this.app.collections.torrents.add_by_url(a),$("#search_text").val("").trigger("input"),this.app.trigger("query:url",!1)):this.is_potential_command(a)?(c=this.get_command(a),this.is_command(c)&&d.track("toolbar","command",c,null),$("#search_text").val("").trigger("input"),this.app.trigger("command",c)):this.collection.search(a,
c)},is_potential_command:function(c){return 0===c.indexOf("/")},is_command:function(c){return!!this.app.commands[c]},get_command:function(c){var a=!1;this.is_potential_command(c)&&(a=c.replace("/",""));return a},is_download_link:function(c){return-1<c.indexOf("://")||-1<c.indexOf("urn:btih")},set_cached_indicator:function(c){c?this.$search_button.addClass("cached"):this.$search_button.removeClass("cached")},set_searching_indicator:function(c){"primary"===c?this.$search_button.addClass("searching"):
this.$search_button.removeClass("searching")},on_history:function(){this.$search_history.html(e.templates.history({history:this.collection._history}))},clear_history:function(c){c.preventDefault();this.collection.observer.trigger("clear");d.track("toolbar","history","clear",null)},render:function(){var c=e.templates.toolbar();this.$el.html(c)}})})})();
(function(){define("alert.view",["require","backbone","handlebars","sandbox_helpers","config"],function(a){var e=a("sandbox_helpers"),d=a("config"),a=Backbone.View.extend({el:null,model:null,timeout:null,delay:3E3,transition:100,types:[],events:{"click .alert":"on_action_click"},initialize:function(c){this.app=c.app;this.types=c.types||this.types;this.collection=this.app.collections.notifications;this.bind_events()},bind_events:function(){this.collection.on("auto_open",this.on_auto_open,this);this.app.on("dialog:close",
this.on_dialog_close,this)},on_dialog_close:function(){this.on_auto_open()},on_action_click:function(c){this.model&&e.track("alert","click",this.model.get("type"),null);var a=this.app.views.dialogs.get("notifications");a.on_action_click.call(a,c,!0)},on_auto_open:function(c){var a=c||this.collection.newest;if(a&&!a.get("alert_seen")&&_.contains(this.types,a.get("type"))){var b=b=a.get("type");this.model=a.clone();(b===d.app.notifications.DOWNLOAD_STARTED||b===d.app.notifications.DOWNLOAD_COMPLETE)&&
_.delay(_.bind(function(){b===d.app.notifications.DOWNLOAD_COMPLETE&&this.app.collections.torrents.sort();this.app.collections.torrents.trigger("focus",a.get("data"),!0)},this),0);this.render()}},fade:function(){this.$el.find(".alert").stop(!0,!0).fadeOut(this.transition);this.set_seen();_.defer(function(){this.model=null})},hide:function(c){clearTimeout(this.timeout);this.$el.find(".alert").stop(!0,!0).hide();c||this.set_seen();_.defer(function(){this.model=null})},set_seen:function(){if(this.model){var c=
this.collection.get(this.model.id);c&&c.alert_seen()}},render:function(){if(this.app.views.dialogs.current)return this.hide(!0);if(this.model&&!this.model.get("alert_seen")){var c=Handlebars.templates.alert(this.model.toJSON());this.$el.html(c);clearTimeout(this.timeout);this.timeout=setTimeout(_.bind(this.fade,this),this.delay)}else this.hide()}});_.each({alert_icon:function(){return new Handlebars.SafeString('<span class="icon icon24 '+this.type+(this.data&&this.data.length&&1<this.data.length?
" grouped":"")+'"><span class="line"></span>'+(this.img?'<img src="'+this.img+'" />':"")+"</span>")},alert_text:function(c){var a='<span class="text">'+e.capitalize(this.name)+" "+this.action.toLowerCase()+": "+Handlebars.helpers.alert_title.apply(this,arguments)+"</span>";return new Handlebars.SafeString(a)},alert_data:function(){e.getNotificationTip(this.data);var c=' data-id="'+this.id+'" data-type="'+this.type+'" data-resolved="'+this.resolved+'" data-data="'+JSON.stringify(this.data)+'"';return new Handlebars.SafeString(c)},
alert_title:function(){return new Handlebars.SafeString(e.getNotificationTip(this.data))}},function(c,a){Handlebars.registerHelper(a,c)});return a})})();
(function(){define("torrent.view",["require","handlebars","backbone","sandbox_helpers"],function(a,e){var d=a("sandbox_helpers"),c=null,f=Backbone.View.extend({torrents:null,tagName:"li",className:"torrent",status:"eta",events:{"click .pause":"action_pause","click .remove":"action_remove","click .start":"action_start","click .open":"action_open_containing",dblclick:"action_open_containing"},stop_propagation:function(b){b.stopPropagation()},initialize:function(){this.torrents=this.options.torrents;
delete this.options.torrents;this.app=this.torrents.app;c||(c=this.app.settings);this.bind_events();this.render();this.torrents.$torrents.prepend(this.$el)},bind_events:function(){this.model.on("change",this.render,this);this.model.on("remove",this.destroy,this)},action_open_containing:function(){this.model.collection.open_containing(this.model);d.track("torrent","open_folder",this.model.get("properties").completed_on?"complete":"incomplete",null)},action_pause:function(b){b.stopPropagation();this.model.pause()},
action_remove:function(b){b.stopPropagation();b=!1;if((this.app._metaKey_down||this.app._ctrlKey_down)&&this.app._shiftKey_down)b=!0;this.model.remove(b);this.$el.find(".status .eta").html("Removing...")},action_start:function(b){b.stopPropagation();this.model.start()},show_status:function(){this.$el.find(".status span."+this.status).show().siblings().hide()},set_status_tip:function(){var b="";this.model.is_completed()?this.$el.find(".status").removeAttr("data-tip"):(this.$el.find(".status").children().each(function(c){c&&
(b+="<br />");b+=$(this).text()}),this.$el.find(".status").attr("data-tip",b))},set_status_class:function(){var b=!1;this.model.is_completed()?(this.$el.hasClass("downloading")&&(b=!0),this.$el.addClass("completed").removeClass("downloading")):(this.$el.hasClass("completed")&&(b=!0),this.$el.addClass("downloading").removeClass("completed"));b&&this.app.trigger("render")},set_state_class:function(){233===this.model.get_state()?this.$el.addClass("paused").removeClass("started"):this.$el.addClass("started").removeClass("paused")},
render:function(){this.el.innerHTML=e.templates.torrent(this.model.toJSON());this.set_status_class();this.show_status();this.set_state_class()},destroy:function(){this.undelegateEvents();$(this.el).removeData().unbind();this.remove();this.model.unbind();Backbone.View.prototype.remove.call(this);if(this.onClose)this.onClose();this.app.trigger("render")}}),b=function(b){if(-1==b||!b)return"\u221e";var c=Number(b);if(63072E3<c)return"\u221e";var a,d,f,e,b="",b=Math.floor(c/31536E3);a=c%31536E3;c=Math.floor(a/
604800);a%=604800;d=Math.floor(a/86400);a%=86400;f=Math.floor(a/3600);a%=3600;e=Math.floor(a/60);a%=60;return b=0<b?"%dy %dw".replace(/%d/,b).replace(/%d/,c):0<c?"%dw %dd".replace(/%d/,c).replace(/%d/,d):0<d?"%dd %dh".replace(/%d/,d).replace(/%d/,f):0<f?"%dh %dm".replace(/%d/,f).replace(/%d/,e):0<e?"%dm %ds".replace(/%d/,e).replace(/%d/,a):"%ds".replace(/%d/,a)},i=function(b,c,a){c=c||5;if(100>b)return 0;for(var d=1,a=~~((a||131072)/c),f=1;f<c;f++)if(b>=a*f)d++;else break;return d};_.each({get_progress:function(b){return b.properties.progress/
10},get_class_up:function(b){return b.properties.completed_on&&!(b.properties.status&1)?"eq_none":"eq_"+i(b.properties.upload_speed,5,43690)},get_class_down:function(b){return b.properties.completed_on?"eq_complete":"eq_"+i(b.properties.download_speed,5,131072)},get_eq_tip:function(b){var c=[];c.push('<div class="eq_tip">');0!==b.properties.completed_on?c.push('<div class="row cf complete"><div class="label">Download Complete</div><div class="value eq_sprite"></div></div>'):c.push('<div class="row cf"><div class="label">Downloading</div><div class="value down">'+
d.getFileSize(b.properties.download_speed)+"ps</div></div>");b.properties.completed_on&&!(b.properties.status&1)?c.push('<div class="row cf none"><div class="label">NOT Sharing</div><div class="value eq_sprite"></div></div>'):c.push('<div class="row cf"><div class="label">Sharing</div><div class="value up">'+d.getFileSize(b.properties.upload_speed)+"ps</div></div>");c.push("</div>");return c.join("")},get_eta:function(c){var a="",d="",f=c.properties,i=f.eta,k=1E3<=f.progress,q=c.properties.status,
r={};_.map("started;checking;start after check;checked;error;paused;queued;loaded".split(";"),function(b,c){Math.pow(2,c)&q&&(r[b]=!0)});r.paused?d="Paused":r.checking?d=f.progress/10+"%":k?k&&(d=_.contains(r,"queued")?"Sharing: "+e.helpers.get_seeding_progress_status.apply(c,[c]):"Complete"):r.queued&&!r.started?a="Queued":!r.queued&&!r.started?(a="Stopped:",d=f.progress/10+"%"):(d=b(i),"\u221e"===d&&(a="ETA: "));return new e.SafeString('<span class="label">'+a+' </span><span class="value">'+d+"</span>")},
get_total_size:function(b){return new e.SafeString(d.getFileSize(b.properties.size))},get_downloaded_size:function(b){var c=d.getFileSize(b.properties.size,1),b=d.getFileSize(~~(b.properties.size*b.properties.progress/1E3),1);return new e.SafeString(b+"/"+c)},get_seeding_progress_status:function(a,f){var e="";if(a.properties.completed_on&&!(a.properties.status&1))return"Not sharing";"time"===c.get("seed_type")?(e=d.getTimestamp(),e=60*c.get("seed_time")-(e-a.properties.completed_on),0>e&&(e=0),e=
b(e),f&&(e=["Sharing for ",e," longer"].join(""))):(e=c.get("seed_percentage"),e=0>=e?"0%":~~(a.properties.ratio/10/(e/100))+"%",f&&(e=["Shared ",e," of file"].join("")));return e},get_active_health:function(b){var c="health_"+d.calculateHealth(b.properties.availability);return new e.SafeString('<span class="health '+c+'" data-tip="'+("<strong>Active Download Health: </strong><div class='cf'>Seeds: "+b.properties.seeds_connected+" / "+b.properties.seeds_in_swarm+" connected</div><div class='cf'>Peers: "+
b.properties.peers_connected+" / "+b.properties.peers_in_swarm+" connected</div>")+'"></span>')},get_torrent_tip:function(b){return["<strong>Double Click to Open</strong>","<div>- "+b.properties.name+"</div>","<div>- "+b.properties.directory+"</div>","<div>- "+e.helpers.get_seeding_progress_status.apply(b,[b,!0])+"</div>"].join("")}},function(b,c){e.registerHelper(c,b)});return f})})();
(function(){define("torrents.view","require handlebars backbone sandbox_helpers alert.view torrent.view config".split(" "),function(a,e){var d=a("sandbox_helpers"),c=a("torrent.view"),f=a("alert.view"),b=a("config");return Backbone.View.extend({el:"#torrent_content",$torrents:null,torrent_views:{},alert:null,initialize:function(c){var a=this;this.app=c.app;delete c.app;this.$el.html(e.templates.torrents());this.$torrents=this.$el.find("#torrents");this.app.trigger("render");this.alert=new f({el:"#torrent_content .alert_container",
types:[b.app.notifications.DOWNLOAD_COMPLETE,b.app.notifications.DOWNLOAD_FAILED,b.app.notifications.DOWNLOAD_STARTED],app:this.app});this.bind_events();_.defer(function(){a.collection.trigger("reset")})},bind_events:function(){this.collection.on("reset",this.on_reset,this);this.collection.on("add",this.on_add,this);this.collection.on("remove",this.on_remove,this);this.collection.on("change",this.render,this);this.collection.on("focus",this.on_focus,this);this.app.on("dialog:close",this.clear_focus,
this)},on_remove:function(b){(b=this.torrent_views[b.id])&&b.destroy();this.render();this.app.trigger("render")},focus_timeout:null,focus_timeout_time:5E3,on_focus:function(b,c){this.focus_timeout&&clearTimeout(this.focusTimeout);var a=1E7,b=d.makeArray(b);_.each(b,_.bind(function(b){hash=b.id.replace('"',"").replace('"',"");b=this.focus(hash).position();b.top<a&&(a=b.top)},this));this.$torrents.scrollTop(a);c&&(this.focus_timeout=setTimeout(_.bind(function(){this.clear_focus()},this),this.focus_timeout_time))},
focus_torrents:function(b){var c=1E7,b=d.makeArray(b);_.each(b,_.bind(function(b){hash=b.id.replace('"',"").replace('"',"");b=this.focus(hash).position();b.top<c&&(c=b.top)},this));this.$torrents.scrollTop(c)},focus:function(b){b=this.torrent_views[b].$el;b.addClass("focused");return b},clear_focus:function(){_.each(this.torrent_views,function(b){b.$el.removeClass("focused")})},on_add:function(b){this.torrent_views[b.id]=new c({model:b,torrents:this});this.render();this.app.trigger("render")},on_reset:function(){for(var b in this.torrent_views)this.torrent_views[b].destroy(),
delete this.torrent_views[b];this.collection.each(this.on_add,this);this.render();this.app.trigger("render")},toggle_empty:function(b){b?($("#torrent_content .message").removeClass("hidden"),this.$torrents.addClass("hidden")):($("#torrent_content .message").addClass("hidden"),this.$torrents.removeClass("hidden"))},render:function(){this.toggle_empty(!this.collection.length)}})})})();
(function(){define("torque_settings.model",["require","backbone","config"],function(a){a("config");return Backbone.Model.extend({observer:null,initialize:function(a,d){this.app=d.app;delete d.app;this.observer=_sandbox.observer.load("app");this.bind_events();this.bind_messages();this.observer.trigger("settings:load")},bind_events:function(){this.on("change",function(){},this)},bind_messages:function(){this.observer.on("settings:changed",_.bind(this.on_settings_changed,this))},on_settings_changed:function(a){this.set(a)},
open_webui:function(){this.observer.trigger("webui:open")}})})})();
(function(){define("dialog.view",["require","backbone","sandbox_helpers"],function(a){var e=a("sandbox_helpers");return Backbone.View.extend({el:"#dialogs",dialog:null,$dialog:null,id:null,initialize:function(a){this.dialogs=a.parent.parent;this.app=a.parent.app;this.create()},close:function(){this.dialogs.close()},cancel:function(){e.track("dialog","cancel",this.id,null);this.close()},open:function(){this.render&&this.render();e.track("dialog","open",this.id);this.$dialog.show()},create:function(){this.$dialog=
$("<div />",{id:this.id}).addClass("dialog");this.dialog=this.$dialog[0];this.$dialog.appendTo(this.$el)}})})})();
(function(){define("engines.dialog.view",["require","backbone","dialog.view"],function(a){var e=a("dialog.view");return e.extend({id:"engines",events:{"click #engines .primary":"on_save","click #engines .cancel":"cancel"},initialize:function(a){e.prototype.initialize.apply(this,arguments)},on_save:function(){var a=this.$dialog.find("input:radio:checked").val();this.collection.enable(a);this.close()},render:function(){var a=Handlebars.templates.engines_dialog();this.$dialog.html(a);this.$dialog.find('input[value="'+
this.app.settings.get("default_engine")+'"]').attr({checked:"checked"})}})})})();
(function(){define("association.dialog.view",["require","backbone","dialog.view"],function(a){var e=a("dialog.view"),a=e.extend({id:"association",events:{"click #association .primary":"on_save"},initialize:function(a){e.prototype.initialize.apply(this,arguments)},on_save:function(){var a=this.$dialog.find("#set_association").is(":checked"),c=this.$dialog.find("#remember_association").is(":checked");this.app.collections.notifications.observer.trigger("remove","association");this.app.settings.set({associate:a,
remember_association:c}).save();this.close()},render:function(){var a=Handlebars.templates.association_dialog(this.app.settings.get());this.$dialog.html(a)}});_.each({set_checked:function(a){return a||_.isNull(a)?'checked="checked':""}},function(a,c){Handlebars.registerHelper(c,a)});return a})})();
(function(){define("add_site.dialog.view",["require","backbone","dialog.view"],function(a){var e=a("dialog.view");return e.extend({id:"add_site",events:{"click #add_site .cancel":"cancel","click #add_site .primary":"on_add_site","keypress #site-url":"on_input_keypress"},initialize:function(a){e.prototype.initialize.apply(this,arguments)},on_input_keypress:function(a){13===a.which&&this.$dialog.find(".primary").trigger("click")},on_add_site:function(a){a.preventDefault();if(a=this.$dialog.find("#site-url").val())this.collection.attempt_add_site(a),
this.close()},render:function(){var a=Handlebars.templates.add_site_dialog();this.$dialog.html(a)}})})})();
(function(){define("notifications.dialog.view","require backbone handlebars dialog.view config timeago sandbox_helpers".split(" "),function(a){var e=a("dialog.view"),d=a("sandbox_helpers");a("config");var c,a=e.extend({id:"notifications",action_pre:"on_",min_priority:75,events:{"click .list li a":"on_action_click","click #notifications .cancel":"on_cancel"},initialize:function(a){e.prototype.initialize.apply(this,arguments);c=this.dialogs;this.bind_events();this.on_auto_open=_.defer(_.bind(this.on_auto_open,
this));var b=this;_.defer(function(){b.collection.trigger("reset")})},bind_events:function(){this.collection.on("auto_open",this.on_auto_open,this)},open:function(){e.prototype.open.apply(this,arguments);this.collection.resolve_all(!0)},on_cancel:function(){this.collection.resolve_all(!1);this.cancel()},on_action_click:function(c,b){var a=$(c.currentTarget).data(),e=this.get_method(a.type);_.isFunction(this[e])?(d.track("notification","click",a.type,1),this[e](a.data,a.id),b||this.collection.resolve_all(!1)):
d.track("notification","click",a.type,0)},on_auto_open:function(){var c=this.collection.highest_priority;if(!c)return!1;if(!(c.get("priority")<this.min_priority)){var b=c.get("type");this[this.get_method(b)](c.get("data"),c.id)}},on_search_site_discovered:function(a,b){this.app.collections.sites.detected.length&&c.open("add_sites",a,b)},on_search_site_declined:function(a,b){c.open("site_manager",a,b);setTimeout(function(){c.get("site_manager").focus(b)},0)},on_search_site_added:function(a,b){c.open("site_manager",
a,b);setTimeout(function(){c.get("site_manager").focus(b)},0)},on_association:function(){c.is_onboarding||c.open("association")},on_pairing_requested:function(a,b){c.open("authorize-pairing",a,b)},on_client_authorized:function(){},on_download_complete:function(c){var b=this;this.app.views.dialogs.close();setTimeout(function(){b.app.collections.torrents.trigger("focus",c)},0)},on_download_started:function(c){this.app.views.dialogs.close();setTimeout(function(){this.app.collections.torrents.trigger("focus",
c)},0)},get_method:function(c){return this.action_pre+c},render:function(){var c=Handlebars.templates.notifications_dialog({notifications:this.collection.toJSON()});this.$dialog.html(c);$("time.timeago").timeago();this.app.trigger("render")}});_.each({notification_icon:function(){return new Handlebars.SafeString('<span class="type '+this.type+(this.data&&this.data.length&&1<this.data.length?" grouped":"")+'">'+(this.img?'<img class="icon16" src="'+this.img+'" />':"")+"</span>")},notification_link:function(){var c=
d.getNotificationTip(this.data),c='<span class="event"><a data-id=\''+this.id+"' data-type='"+this.type+"' data-resolved='"+this.resolved+"' data-data='"+JSON.stringify(this.data)+"' data-tip='"+c+"'>"+this.name+" "+this.action+": "+c+"</a></span>";return new Handlebars.SafeString(c)},notification_time:function(){return new Handlebars.SafeString('<span class="time">'+this.timestamp+"</span>")},iso_date:function(c){return JSON.parse(JSON.stringify(new Date(1E3*c))).replace(".000Z","Z")},resolved_class:function(){return this.seen?
"resolved":"unresolved"}},function(c,b){Handlebars.registerHelper(b,c)});return a})})();
(function(){define("settings.dialog.view",["require","backbone","dialog.view"],function(a){var e=a("dialog.view"),d=function(c){var a="",b=c%60,d=Math.floor(c/60);0<d&&(a+=d+" hour"+(1<d?"s":""));0<b&&(a=a.replace(/\shours?/,"h "),a+=b+" minutes");360<c&&(a="Forever");0===b&&0===d&&(a="None");return a};return e.extend({id:"settings",model:null,observer:null,events:{"click .js-select-download-dir":"set_download_directory","click #settings .cancel":"cancel","change #settings input":"on_settings_changed"},
initialize:function(c){e.prototype.initialize.apply(this,arguments);this.model=this.app.torque_settings;this.observer=_sandbox.observer.load("app");this.bind_events();this.render()},bind_events:function(){this.app.settings.on("change:seed_percentage",_.bind(this.seed_percentage_changed,this));this.app.settings.on("change:seed_time",_.bind(this.seed_time_changed,this));this.app.settings.on("change:seed_type",_.bind(this.seed_type_changed,this));this.app.settings.on("change:associate",_.bind(this.associate_changed,
this));this.model.on("change:download_directory",this.on_download_directory_changed,this)},set_download_directory:function(){this.observer.trigger("settings:set_dl_dir")},on_settings_changed:function(c,a){var b=$(c.currentTarget),e=b.val();switch(b.attr("id")){case "seed_time":$("#seed_time_text").text(d(e));break;case "seed_percentage":$("#seed_percentage_text").text(e+"%");break;case "seed_type_percentage":case "seed_type_time":$(".seed-option").addClass("hidden");$("#"+b.data("options")).removeClass("hidden");
break;case "set_association_setting":e=!!b.attr("checked")}a||this.app.settings.set(b.attr("name"),e).save()},on_download_directory_changed:function(c,a){a=this.model.get("download_directory");this.setting_changed("dir_active_download",a)},seed_percentage_changed:function(){var c=this.app.settings.get("seed_percentage");this.setting_changed("seed_percentage",c)},seed_time_changed:function(){var c=this.app.settings.get("seed_time");this.setting_changed("seed_time",c)},seed_type_changed:function(){var c=
this.app.settings.get("seed_type");this.setting_changed("seed_type_"+c,!0);$(".seed-option").addClass("hidden");$("#seed_"+c+"_options").removeClass("hidden")},associate_changed:function(){var c=this.app.settings.get("associate");this.setting_changed("set_association_setting",c)},setting_changed:function(c,a){var b=$("#"+c);"checkbox"===b.attr("type")||"radio"===b.attr("type")?b.prop("checked",a).trigger("change",!0):b.val(a).trigger("change",!0)},render:function(){var c=Handlebars.templates.settings_dialog();
this.$dialog.html(c);this.render_settings()},render_settings:function(){_.defer(_.bind(function(){this.model.trigger("change:download_directory");this.app.settings.trigger("change:seed_type");this.app.settings.trigger("change:seed_percentage");this.app.settings.trigger("change:seed_time");this.app.settings.trigger("change:associate")},this))}})})})();
(function(){define("add_sites.dialog.view",["require","handlebars","backbone","sandbox_helpers","dialog.view"],function(a){var e=a("dialog.view"),d=a("sandbox_helpers"),a=e.extend({id:"add_sites",events:{"click .site .remove":"remove_site","click #add_sites .cancel":"on_cancel","click #add_sites .primary":"on_save"},initialize:function(c){e.prototype.initialize.apply(this,arguments)},on_cancel:function(){var c=this;this.$dialog.find(".site").each(function(){var a=$(this).data("id");c.collection.disable(a);
$(this).remove()});this.cancel()},on_save:function(){var c=this;this.$dialog.find(".site").each(function(){var a=$(this).data("id");c.collection.enable(a);$(this).remove()});this.close()},remove_site:function(c){var c=$(c.currentTarget).closest(".site"),a=c.parent(),b=c.data("id");this.collection.disable(b);c.remove();c=a.children(".site").length;d.track("dialog","disable_site",this.id,c);c||this.close()},render:function(){if(!this.collection.detected.length)return this.close();var c=Handlebars.templates.add_sites({sites:this.collection.detected});
this.$dialog.html(c)}});_.each({add_sites_icon:function(){return new Handlebars.SafeString('<span class="icon">'+(this.favicon?'<img src="'+this.favicon+'" />':"")+"</span>")},add_sites_header:function(c){var a="Search site";1<c.sites.length&&(a=c.sites.length+" search sites");return a+" detected!"}},function(a,d){Handlebars.registerHelper(d,a)});return a})})();
(function(){define("pairing.dialog.view",["require","backbone","dialog.view"],function(a){var e=a("dialog.view");return e.extend({id:"authorize-pairing",initialize:function(a){e.prototype.initialize.apply(this,arguments)},render:function(){}})})})();
(function(){define("remote_asset.dialog.view",["require","backbone","dialog.view"],function(a){var e=a("dialog.view");return e.extend({id:"remote_asset",events:{"click #remote_asset .cancel":"cancel","click #remote_asset .primary":"close"},initialize:function(a){e.prototype.initialize.apply(this,arguments);var c=Handlebars.templates.remote_asset();this.$dialog.html(c);this.setup_iframe();this.$icon=this.$dialog.find(".remote_asset_icon");this.bind_events()},bind_events:function(){$(window).on("message",
_.bind(this.on_message,this))},on_message:function(a){if(a.originalEvent.source===this.iframe.contentWindow){var c=a.originalEvent,a=c.data.key,e=c.data.data,c=c.source;if(this["on_"+a])this["on_"+a](e,c,a)}},send_message:function(a,c,e){e.postMessage({key:a,data:c},"*")},on_get_commands:function(a,c,e){this.send_message(e,this.app.commands,c)},on_open_tab:function(a){Bt.msg.send(Bt.events.OPEN_TAB,a,"ext")},on_do_command:function(a){this.app.do_command(a)},setup_iframe:function(){this.iframe=document.createElement("iframe");
$(this.iframe).appendTo(this.$dialog.find("#remote_iframe_container"))},set_title:function(a){this.$dialog.find(".dialog_header .text").text(a)},set_icon:function(a){a?(this.$icon.find("img").attr({src:a}),this.$icon.show()):this.$icon.hide()},load:function(a){this.set_title(a.title);this.set_icon(a.icon);$(this.iframe).attr("class",a.cls);this.iframe.src=a.url},unload:function(){this.iframe.src=null}})})})();
(function(){define("site_manager.dialog.view",["require","backbone","handlebars","dialog.view","sandbox_helpers"],function(a){var e=a("dialog.view"),d=a("sandbox_helpers"),a=e.extend({id:"site_manager",events:{"change .switch_input":"toggle_site",'change [name="search_engine"]':"on_default_engine_change","click #site_manager .cancel":"cancel"},initialize:function(a){e.prototype.initialize.apply(this,arguments);this.bind_events()},bind_events:function(){this.collection.on("reset",this.render,this);
this.app.on("dialog:close",this.clear_focus,this)},focus:function(a){this.$dialog.find('[data-id="'+a+'"]').closest("li").addClass("focused")},clear_focus:function(){this.$dialog.find(".focused").removeClass("focused")},toggle_site:function(a){var a=$(a.currentTarget),e=a.data("id");"search_default"===e&&(e=this.$dialog.find('[name="search_engine"]:radio:checked').val());this.toggle_switch(a);a.is(":checked")?(this.collection.enable(e),d.track("dialog","enable_site",this.dialogs.current,null)):(this.collection.disable(e),
d.track("dialog","disable_site",this.dialogs.current,null))},toggle_switch:function(a){a.siblings(".switch").toggleClass("checked",a.is(":checked"))},on_default_engine_change:function(a,d){var b=$(a.currentTarget),e=b.val();this.$dialog.find('[name="search_engine"]').removeAttr("checked");b.attr({checked:"checked"});d||(this.app.settings.set({default_engine:e}).save(),this.$dialog.find("#search_default").attr({checked:"checked"}).trigger("change",!0))},render_default_engine:function(){var a=this.app.settings.get(),
d=this.collection.default_engine,b=this.$dialog.find("#search_default");d?b.attr({checked:"checked"}):b.removeAttr("checked");this.toggle_switch(b);this.$dialog.find('[name="search_engine"][value="'+a.default_engine+'"]').trigger("change",!0)},render:function(){var a=Handlebars.templates.site_manager({sites:this.collection.toJSON()});this.$dialog.html(a);this.delegateEvents();this.render_default_engine();this.app.trigger("render");return this}});_.each({site_enabled:function(){return this.enabled?
"checked":""},get_site_name:function(a){switch(a){case "archive":return"Internet Archive";case "btfc":return"BitTorrent Featured Content"}return a.capitalize()}},function(a,d){Handlebars.registerHelper(d,a)});return a})})();
(function(){define("dialogs.model","require backbone engines.dialog.view association.dialog.view add_site.dialog.view notifications.dialog.view settings.dialog.view add_sites.dialog.view pairing.dialog.view remote_asset.dialog.view site_manager.dialog.view".split(" "),function(a){var e=a("engines.dialog.view"),d=a("add_site.dialog.view"),c=a("association.dialog.view"),f=a("site_manager.dialog.view"),b=a("notifications.dialog.view"),i=a("settings.dialog.view"),m=a("add_sites.dialog.view"),h=a("remote_asset.dialog.view"),
g=a("pairing.dialog.view");return Backbone.Model.extend({initialize:function(b,a){this.app=a.app;this.parent=a.parent;this.setup()},setup:function(){this.set({engines:new e({parent:this,collection:this.app.collections.sites}),association:new c({parent:this}),add_site:new d({parent:this,collection:this.app.collections.search}),site_manager:new f({parent:this,collection:this.app.collections.sites}),settings:new i({parent:this}),add_sites:new m({parent:this,collection:this.app.collections.sites}),pairing:new g({parent:this}),
remote_asset:new h({parent:this}),notifications:new b({parent:this,collection:this.app.collections.notifications})})},setup_views:function(){},bind_events:function(){},bind_messages:function(){}})})})();
(function(){define("dialogs.view",["require","backbone","dialogs.model"],function(a){var e=a("dialogs.model");return Backbone.View.extend({model:null,current:!1,is_onboarding:"",initialize:function(a){this.app=a.app;this.model=new e(null,{app:this.app,parent:this});this.$main=$(".main")},get:function(a){return this.model.get(a)},close:function(){this.is_onboarding&&this.app.trigger("onboard:progress",this.is_onboarding);"remote_asset"===this.current&&this.app.views.dialogs.model.get("remote_asset").unload();
this.$main.removeClass("dialog").find(".dialog").hide();this.current=null;this.app.trigger("dialog:close");this.app.trigger("render")},open:function(a,c,e){this.$main.addClass("dialog").find(".dialog").hide();this.current=a;this.get(a).open(c,e);this.app.trigger("render")}})})})();
(function(){define("site.model",["require","backbone","config"],function(a){var e=a("config");return Backbone.Model.extend({initialize:function(){this.get("favicon")||this.set({favicon:e.data_path+"app/img/icon_favicon.png"});this.typeChanged();this.on("change:type",this.typeChanged,this)},typeChanged:function(){this.set("enabled","added"===this.get("type"))}})})})();
(function(){define("sites.collection",["require","backbone","site.model"],function(a){a=a("site.model");return Backbone.Collection.extend({model:a,observer:null,default_engines:[],default_engine:null,detected:[],initialize:function(a,d){this.app=d.app;this.observer=_sandbox.observer.load("sites");this.bind_events();this.observer.trigger("load")},bind_events:function(){this.observer.on("reset",_.bind(this.on_sites_received,this))},enable:function(a){this.observer.trigger("enable",{key:a})},disable:function(a){this.observer.trigger("disable",
{key:a})},on_sites_received:function(a){this.default_engines=_.keys(a.defaults);this.default_engine=null;this.detected=[];var d=[],c=this;_.each(a,function(a,b){if(_.contains(["defaults","skipped"],b))return!0;_.each(a,function(a,e){if(_.contains(c.default_engines,e))return c.default_engine=_.extend(a.data,{id:e,type:b}),!0;("detected"===b?c.detected:d).push(_.extend(a.data,{id:e,type:b}))})});this.reset(d)},comparator:function(a){return a.get("id")}})})})();
(function(){define("result.model",["require","backbone","config"],function(a){a("config");return Backbone.Model.extend({initialize:function(){this.checkFavicon();this.get("duplicates")||this.set("duplicates",null);this.on("change:favicon",this.checkFavicon,this)},checkFavicon:function(){_.isEmpty(this.get("favicon"))&&this.set({favicon:Handlebars.helpers.root()+"img/icon_favicon.png"})},shouldWait:function(){return!!this.get("wait")},isDuplicate:function(){return!!this.get("is_duplicate")}})})})();
(function(){define("search.collection",["require","backbone","sandbox_helpers","result.model"],function(a){var e=a("result.model"),d=a("sandbox_helpers");return Backbone.Collection.extend({model:e,_last_query:"",_history:[],_recommendations:[],observer:null,parser_observer:null,_searching:!1,initialize:function(a,d){this.app=d.app;this.observer=_sandbox.observer.load("search");this.parser_observer=_sandbox.observer.load("parser");this.throttled_sort=_.throttle(_.bind(function(){this.sort({silent:!0});
this.trigger("sort")},this),1E3);this.announce_recommendations=_.debounce(_.bind(this.announce_recommendations,this),0);this.filter_recommendations=_.throttle(_.bind(this.filter_recommendations,this),250);this.bind_events();this.load()},bind_events:function(){this.observer.on("full_results",_.bind(this.on_cached_results,this));this.observer.on("complete",_.bind(this.on_complete,this));this.observer.on("result",_.bind(this.on_result_update,this));this.observer.on("history",_.bind(this.on_history,this));
this.on("reset",this.filter_recommendations,this)},on_history:function(a){this._history=a;this.trigger("history",this._history)},on_complete:function(a,d){a===this._last_query&&(this._searching=d,this.trigger("searching",this._searching))},on_cached_results:function(a){this._last_query=a.query;this._searching=a.searching;this.trigger("cached",a.cached,a.query);this.trigger("searching",this._searching);this.reset(a.results)},load:function(){this.observer.trigger("load")},search:function(a,d,b){this._last_query=
a;this._recommendations=[];this.reset();this._searching="primary";this.trigger("searching",this._searching);a={query:a,cached:d};b&&(a.btfc_adv=!0);this.observer.trigger("search",a)},attempt_add_site:function(a){this.parser_observer.trigger("check",{url:a,manual:!0})},calculate_scrape_order:function(a){return!a.get("scraped")?-2:a.get("scraped").error?-1:d.calculateHealth(d.getScrapedAvailability(a.get("scraped")))},get_query_terms:function(){var a="",d=[];return function(){this._last_query!==a&&
(a=this._last_query,d=a.replace(/[\.,-\/#!$%\^&\*;:{}=\-_`~()]/g," ").replace(/\s{2,}/g," ").toLowerCase().split(" "));return d}}(),comparator:function(a,d){var b=!!a.get("is_btfc_result"),e=!!d.get("is_btfc_result");if(b!==e)return b?-1:1;b=this.calculate_scrape_order(a);e=this.calculate_scrape_order(d);if(b!==e&&(-1<b||-1<e))return e-b;var b=a.get("torrent").name.toLowerCase(),e=d.get("torrent").name.toLowerCase(),m=this.get_query_terms(),h=function(b){return-1<this.indexOf(b)},g=_.every(m,h,b),
j=_.every(m,h,e);if(g&&!j)return-1;if(j&&!g)return 1;if(!j&&!g){g=_.some(m,h,b);m=_.some(m,h,e);if(g&&!m)return-1;if(m&&!g)return 1}return b===e?0:b<e?-1:1},on_result_update:function(a){var d=this.get(a.id);d?d.set(a):(this.add(a),a.is_btfc_recommendation&&this.filter_recommendations());this.throttled_sort()},filter_recommendations:function(){var a=this,d=this.where({is_btfc_recommendation:!0}).filter(function(b){return!a.app.collections.torrents.where({uri:b.get("download").torrent}).length});this._recommendations=
_.sortBy(d,function(b){return b.get("order")});this.announce_recommendations()},announce_recommendations:function(){this._recommendations.length&&this.trigger("recommendations",this._recommendations)}})})})();
(function(){define("torrent.model",["require","backbone","sandbox_helpers","config"],function(a){a("config");var e=a("sandbox_helpers");return Backbone.Model.extend({initialize:function(a){this.set("uri",a.properties.uri)},get_state:function(){return this.get("properties").status},is_completed:function(){return this.get("properties").completed_on||0},pause:function(){e.track("torrent","pause",this.get("properties").completed_on?"complete":"incomplete",null);this.collection.observer.trigger("torrent:pause",
this.id);this.get("properties").status=233;this.trigger("change")},start:function(){e.track("torrent","start",this.get("properties").completed_on?"complete":"incomplete",null);this.collection.observer.trigger("torrent:start",this.id);this.get("properties").status=201;this.trigger("change")},remove:function(a){e.track("torrent","remove",this.get("properties").completed_on?"complete":"incomplete",null);this.collection.observer.trigger("torrent:remove",this.id,a)}})})})();
(function(){define("torrents.collection",["require","backbone","sandbox_helpers","torrent.model"],function(a){var e=a("torrent.model");a("sandbox_helpers");return Backbone.Collection.extend({model:e,_ready:!1,observer:null,initialize:function(a){this.app=a.app;this.observer=_sandbox.observer.load("app");this.throttled_request_torrents=_.throttle(_.bind(this.request_torrents,this),1E3);this.bind_events();this.bind_messages();this.request_torrents()},bind_events:function(){this.observer.on("torrents:ready",
_.bind(this.on_torrents_ready,this));this.observer.on("torrent:properties",_.bind(this.on_torrent_properties_update,this));this.observer.on("torrent:added",_.bind(this.on_torrent_added,this));this.observer.on("torrent:removed",_.bind(this.on_torrent_removed,this))},bind_messages:function(){},request_torrents:function(){this.observer.trigger("torrents:load")},on_torrents_ready:function(a){this._ready=!0;this.reset(a)},on_torrent_properties_update:function(a,c){var e=this.get(a);e&&(_.extend(e.get("properties"),
c),e.trigger("change"))},on_torrent_added:function(a){this._ready&&(this.add(a,{silent:!0}),this.trigger("reset"))},on_torrent_removed:function(a){(a=this.get(a.id))&&this.remove(a)},add_by_url:function(a,c){this.observer.trigger("torrent:add_url",a,c)},open_containing:function(a){a||(a=this.first());a&&this.observer.trigger("torrent:open",a.id)},comparator:function(a,c){var e=a.get("properties"),b=c.get("properties");a.set("completed_on",e.completed_on);c.set("completed_on",b.completed_on);if(e.queue_order!==
b.queue_order)return 0>e.queue_order?-1:0>b.queue_order?1:b.queue_order-e.queue_order;e=e.name.toLowerCase();b=b.name.toLowerCase();return e<b?1:e>b?-1:0}})})})();
(function(){define("result.view",["require","handlebars","backbone","sandbox_helpers"],function(a,e){var d=a("sandbox_helpers"),c=Backbone.View.extend({tagName:"li",events:{"click .download":"action_download","click a.js-open-tab":"on_link_click","click .js-toggle-expandable":"toggle_expandable"},initialize:function(a){this.app=a.app;this.parent=a.parent;this.model.view=this;this.bind_events();this.render();this.put_in_place()},bind_events:function(){this.model.on("change",this.render,this)},destroy:function(){this.undelegateEvents();
this.$el.removeData().unbind();this.remove();Backbone.View.prototype.remove.call(this)},action_download:function(a){a.preventDefault();a.stopPropagation();$(a.currentTarget);url=a.currentTarget.href;downloading=$(a.currentTarget).hasClass("downloading");(this.app._metaKey_down||this.app._ctrlKey_down)&&this.app._shiftKey_down?(this.app.copy(url),d.track("search","result","clip",0)):(this.model.set({downloaded:!0}),downloading||(a=this.$el.children(".title").text(),this.show_as_downloading(),this.app.collections.torrents.add_by_url(url,
a)),d.track("search","result","download",downloading?-2:0))},on_link_click:function(){d.track("search","result","open_link",this.app.views.app._metaKey_down||this.app.views.app._ctrlKey_down?1:0)},toggle_expandable:function(a){a.preventDefault();d.track("search","result",this.$el.hasClass("open")?"collapse":"expand",null)},show_as_downloading:function(){this.$(".download").addClass("downloading").attr("data-tip","Downloading")},render:function(){var a=!this.model.shouldWait()&&!this.model.isDuplicate()&&
!this.model.get("is_btfc_recommendation"),b=this.$el.hasClass("open"),c=this.model.toJSON();c.duplicates&&(c.duplicates=_.toArray(c.duplicates));this.$el.html(e.templates.result(c));this.$el.toggleClass("hidden",!a);this.$el.toggleClass("combined expandable",!!c.duplicates);this.$el.toggleClass("open",b);this.$el.toggleClass("btfc",!!c.is_btfc_result)},put_in_place:function(){this.parent.$results_el.append(this.$el);this.app.trigger("render")}});_.each({scrape_health:function(a){var b="",c="<strong>Estimated Torrent Health:</strong>";
a.scraped?a.scraped.error?(b="shrug",c="No health information available"):(b="health_"+d.calculateHealth(d.getScrapedAvailability(a.scraped)),_.isNumber(a.scraped.complete)&&(c+="<div>People Sharing: <span class='right'>"+a.scraped.complete+"</span></div>"),_.isNumber(a.scraped.incomplete)&&(c+="<div>People Downloading: <span class='right'>"+a.scraped.incomplete+"</span></div>"),_.isNumber(a.scraped.downloaded)&&(c+="<div>Total Downloaded: <span class='right'>"+a.scraped.downloaded+"</span></div>")):
(b="unknown",c="No health information available");return new e.SafeString('<span class="health '+b+'" data-tip="'+c+'"> </span>')},get_result_size:function(a){a=a.files_size?d.getFileSize(a.files_size,0):"";return new e.SafeString(a)},getFavicon:function(a){return a||e.helpers.root()+"img/icon_favicon.png"},get_title_tip:function(a){var b="File: "+a.torrent.name+'<div class="ellipse">URL: '+a.torrent.url+"</div>";a.files_size&&(b+='<div class="ellipse">Size: '+d.getFileSize(a.files_size,0));NaN;return b},
get_download_link_tip:function(a){var b="";a.files_size&&(b=" "+d.getFileSize(a.files_size,0));return"<strong>Click to Download:</strong>"+a.torrent.name+b},get_tab_link_tip:function(a){return a.torrent&&a.torrent.url?"More info at "+a.torrent.url.getBasePath():""},get_result_name:function(a){return a.is_btfc_result&&a.hasOwnProperty("torrent")?new e.SafeString('<a href="'+a.torrent.url+'" class="js-open-tab">'+a.torrent.name+"</a>"):a.torrent.name}},function(a,b){e.registerHelper(b,a)});return c})})();
(function(){define("suggestion.view",["require","handlebars","backbone","sandbox_helpers"],function(a,e){var d=a("sandbox_helpers"),c=Backbone.View.extend({tagName:"div",_suggestion:null,initialize:function(a){this.app=a.app;a.suggestion&&(this._suggestion=a.suggestion);this.bind_events();this.render()},bind_events:function(){},destroy:function(){this.undelegateEvents();this.$el.removeData().unbind();this.remove();Backbone.View.prototype.remove.call(this)},render:function(){var a;this.model?(a=e.templates.suggestion({model:this.model.toJSON()}),
_.defer(_.bind(function(){this.$el.find(".suggestion").addClass("recommendation")},this))):a=e.templates.suggestion({spelling:this._suggestion});this.$el.html(a)}});_.each({capitalize:function(a){return d.capitalize(a)},get_first_genre:function(a){return a.model.recommended_genres[0]},get_first_genre_capitalized:function(a){return d.capitalize(e.helpers.get_first_genre.apply(this,arguments))}},function(a,b){e.registerHelper(b,a)});return c})})();
(function(){define("search.view","require handlebars backbone sandbox_helpers alert.view result.view suggestion.view config".split(" "),function(a,e){a("sandbox_helpers");var d=a("result.view"),c=a("alert.view"),f=a("suggestion.view"),b=a("config");return Backbone.View.extend({el:"#search_results",results:[],$results_el:null,$empty:null,_suggestion:null,$suggestion:null,alert:null,initialize:function(a){this.app=a.app;this.$el.html(e.templates.search());this.render();this.$empty=this.$el.find("#no_results");
this.$results_el=this.$el.find(".content");this.$suggestion=this.$el.find("#suggestion");this.alert=new c({el:"#search_results .alert_container",types:[b.app.notifications.SEARCH_SITE_ADDED,b.app.notifications.SEARCH_SITE_DECLINED,b.app.notifications.ATTEMPT_ADD_SITE,b.app.notifications.SEARCH_SITE_ADD_FAIL,b.app.notifications.SEARCH_COMPLETE,b.app.notifications.SCRAPE_COMPLETE,b.app.notifications.SEARCH_START,b.app.notifications.CLIP],app:this.app});this.bind_events()},bind_events:function(){var a=
this;this.collection.on("reset",this.on_collection_reset,this);this.collection.on("add",this.on_add,this);this.collection.on("sort",this.on_sort,this);this.collection.on("all",this.render,this);this.collection.on("recommendations",this.on_recommendations,this);this.collection.parser_observer.on("spell",function(b){a.set_suggestion(b,!1)})},set_suggestion:function(a,b){if(b){if(a&&(!this._suggestion||this._suggestion.model)&&!(this._suggestion&&this._suggestion.model===a))this._suggestion&&this._suggestion.destroy(),
this._suggestion=new f({app:this.app,model:a}),this.$suggestion.append(this._suggestion.$el)}else this._suggestion&&this._suggestion.destroy(),this._suggestion=new f({app:this.app,suggestion:a}),this.$suggestion.append(this._suggestion.$el)},on_recommendations:function(a){this.set_suggestion(a[0],!0)},on_collection_reset:function(){var a=this.collection.models;this.destroy_views();a.length?this.$empty.hide():this.$empty.show();this.collection.each(this.on_add,this)},destroy_views:function(){for(var a=
this.results.length;a;)this.results.pop().destroy(),a--;this._suggestion&&this._suggestion.destroy();this._suggestion=null},on_add:function(a){this.$empty.hide();a=new d({model:a,app:this.app,parent:this});this.results.push(a)},on_sort:function(){this.collection.each(function(a){a.view.put_in_place()},this)},render:function(){this.app.trigger("render")}})})})();
(function(){define("notification.model",["require","backbone","config"],function(a){a("config");return Backbone.Model.extend({alert_seen:function(){if(this.get("alert_seen"))return!1;this.collection.observer.trigger("update",this.id,{resolved:this.get("resolved"),alert_seen:!0},{})}})})})();
(function(){define("notifications.collection",["require","backbone","config","notification.model"],function(a){var e=a("notification.model");a("config");return Backbone.Collection.extend({model:e,current_url:"",highest_priority:null,newest:null,observer:null,_raw_unresolved_length:0,_min_priority:50,initialize:function(a,c){this.app=c.app;this.observer=_sandbox.observer.load("notifications");this.bind_events();this.observer.trigger("load")},bind_events:function(){this.on("reset",this.auto_open,this);
this.observer.on("reset",_.bind(this.process,this));this.observer.on("url",_.bind(this.set_current_url,this))},auto_open:function(){var a=this.where({resolved:!1}),c=_.sortBy(a,function(a){return~a.get("timestamp")}),a=_.sortBy(a,function(a){return~a.get("priority")});this.highest_priority=a.length?a[0]:null;this.newest=c.length?c[0]:null;this.trigger("auto_open")},current_url_in_sites_model:function(a){a=_.map(a.get("data"),function(a){return a.url});return _.include(a,this.current_url)},set_current_url:function(a){this.current_url=
a},resolve_all:function(a){this.observer.trigger("resolve",null,!!a)},process:function(a){var c=this;this._raw_unresolved_length=0;_.each(a,function(a){!a.resolved&&a.priority>=c._min_priority&&c._raw_unresolved_length++});this.reset(a)},comparator:function(a,c){var e=a.get("timestamp");return c.get("timestamp")-e}})})})();
(function(){define("app","require q backbone templates app.view tip.view toolbar.view torrents.view torque_settings.model config dialogs.view sites.collection search.collection torrents.collection search.view sandbox_helpers notifications.collection".split(" "),function(a){var e=a("q"),d=a("sandbox_helpers"),c=a("backbone"),f=a("app.view"),b=a("tip.view"),i=a("toolbar.view"),m=a("torrents.view"),h=a("dialogs.view"),g=a("search.view"),j=a("sites.collection"),l=a("torrents.collection"),k=a("notifications.collection"),
q=a("search.collection"),r=a("torque_settings.model"),s=a("config"),a=s.is_ff()?"../../":s.data_path;"remote"===_config.source&&(a=_config.app.remote_src[_config.env]+_config.version+"/");return c.Model.extend({views:{},collections:{},settings:null,torque_settings:null,observer:null,clipboard:null,_metaKey_down:!1,_ctrlKey_down:!1,_shiftKey_down:!1,first_run:{"true":-1,"surf:welcome":-1,"surf:engines":-1,"surf:associate":-1},commands:{surf:{desc:"Displays Surf Commands",title:"Surf Commands",url:a+
"app/popup/remote_assets/commands/commands.html",cls:"commands"},"surf:welcome":{desc:"Displays Welcome Screen",title:"Welcome to BitTorrent Surf",icon:a+"app/img/bt0_icon_32.png",url:a+"app/popup/remote_assets/welcome/welcome.html",cls:"welcome"},"surf:engines":{desc:"Change Default Search Engine"},"surf:associate":{desc:"Change .Torrent and Magnet Link Association."},"surf:reset":{desc:"Resets Surf to Defaults"},"surf:BTFC-":{desc:"Advanced Query on BitTorrent Featured Content"}},initialize:function(){this.observer=
_sandbox.observer.load("popup");this.clipboard=_sandbox.observer.load("clipboard");this.throttled_render=this.on_render;this.bind_events();var a=this.setup_collections();a.done(_.bind(this.setup_views,this));a.done(_.bind(this.setup_settings_dependent_views,this))},bind_events:function(){this.on("command",this.do_command,this);this.on("onboard:progress",this.on_onboard_progress,this);this.on("render",this.throttled_render,this)},$body:$("body"),on_render:function(){this.$body.trigger("resize")},setup_collections:function(){var a=
e.defer();this.settings=_sandbox.storage.load("settings",{wait:300,defaults:s.app.settings_defaults}).on("reset",function(){a.resolve()}).on("change:first_run",_.bind(this.on_first_run,this));this.torque_settings=new r({},{app:this});this.collections={sites:new j([],{app:this}),notifications:new k([],{app:this}),search:new q([],{app:this}),torrents:new l([],{app:this})};return a.promise},setup_views:function(){_.extend(this.views,{app:new f({app:this}),tip:new b({app:this}),toolbar:new i({app:this,
collection:this.collections.search}),search:new g({app:this,collection:this.collections.search}),torrents:new m({app:this,collection:this.collections.torrents})});this.collections.search.trigger("reset");this.trigger("render")},setup_settings_dependent_views:function(){_.extend(this.views,{dialogs:new h({app:this})});_.defer(_.bind(this.on_first_run,this));this.trigger("render")},copy:function(a){this.clipboard.trigger("copy",a)},do_command_timeout:null,do_command:function(a,b){var c;0===a.indexOf("surf:BTFC-")&&
(c=a.replace("surf:BTFC-",""),a="surf:BTFC-");var e=this.commands[a]||this.commands.surf;this.do_command_timeout&&clearTimeout(this.do_command_timeout);if(e&&e.url)this.views.dialogs.get("remote_asset").load(e),this.views.dialogs.open("remote_asset");else switch(a){case "surf:engines":this.views.dialogs.open("engines");break;case "surf:reset":d.track("search","history","clear",null);this.observer.trigger("reset");break;case "surf:BTFC-":d.track("recommendation","genre_query",c,null);this.collections.search.search(c,
!1,!0);break;case "surf:associate":this.views.dialogs.open("association")}b&&(b.hide&&-1<b.hide)&&(this.do_command_timeout=setTimeout(_.bind(function(){this.views.dialogs.is_onboarding===a&&this.views.dialogs.close()},this),b.hide))},on_onboard_progress:function(a){this.settings.set({first_run:a}).save()},on_first_run:function(){var a=this.settings.get("first_run"),b=!1,c=this.first_run,d=!1;"boolean"===typeof a&&(a=a.toString());for(var e in c)if(d){b=e;break}else e===a&&(d=!0);b?(this.views.dialogs.is_onboarding=
b,this.do_command(b,{onboarding:!0,hide:c[b]})):"false"!==a&&(this.views.dialogs.is_onboarding=!1,this.on_onboard_progress(!1))}})})})();
